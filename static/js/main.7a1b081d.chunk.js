(this.webpackJsonptimemap=this.webpackJsonptimemap||[]).push([[0],{238:function(e){e.exports=JSON.parse('{"dateTime":"%x, %X","date":"%d/%m/%Y","time":"%-I:%M:%S %p","periods":["AM","PM"],"days":["domingo","lunes","martes","mi\xe9rcoles","jueves","viernes","s\xe1bado"],"shortDays":["dom","lun","mar","mi\xe9","jue","vie","s\xe1b"],"months":["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],"shortMonths":["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]}')},257:function(e,t){},259:function(e,t){},270:function(e,t){},272:function(e,t){},297:function(e,t){},299:function(e,t){},300:function(e,t){},305:function(e,t){},307:function(e,t){},327:function(e,t){},343:function(e,t){},346:function(e,t){},369:function(e,t,s){},398:function(e,t,s){"use strict";s.r(t);var i={};s.r(i),s.d(i,"fetchDomain",(function(){return pe})),s.d(i,"FETCH_ERROR",(function(){return he})),s.d(i,"fetchError",(function(){return me})),s.d(i,"UPDATE_DOMAIN",(function(){return ge})),s.d(i,"updateDomain",(function(){return je})),s.d(i,"fetchSource",(function(){return be})),s.d(i,"UPDATE_HIGHLIGHTED",(function(){return fe})),s.d(i,"updateHighlighted",(function(){return Oe})),s.d(i,"UPDATE_SELECTED",(function(){return ve})),s.d(i,"updateSelected",(function(){return Se})),s.d(i,"UPDATE_DISTRICT",(function(){return xe})),s.d(i,"updateDistrict",(function(){return Ee})),s.d(i,"CLEAR_FILTER",(function(){return _e})),s.d(i,"clearFilter",(function(){return ye})),s.d(i,"TOGGLE_ASSOCIATIONS",(function(){return Te})),s.d(i,"toggleAssociations",(function(){return Ce})),s.d(i,"TOGGLE_SHAPES",(function(){return Ne})),s.d(i,"toggleShapes",(function(){return Re})),s.d(i,"SET_LOADING",(function(){return Ae})),s.d(i,"setLoading",(function(){return we})),s.d(i,"SET_NOT_LOADING",(function(){return ke})),s.d(i,"setNotLoading",(function(){return Ie})),s.d(i,"SET_INITIAL_CATEGORIES",(function(){return Le})),s.d(i,"setInitialCategories",(function(){return De})),s.d(i,"SET_INITIAL_SHAPES",(function(){return Pe})),s.d(i,"setInitialShapes",(function(){return Ue})),s.d(i,"UPDATE_TIMERANGE",(function(){return He})),s.d(i,"updateTimeRange",(function(){return Me})),s.d(i,"UPDATE_DIMENSIONS",(function(){return Ge})),s.d(i,"updateDimensions",(function(){return Fe})),s.d(i,"UPDATE_NARRATIVE",(function(){return $e})),s.d(i,"updateNarrative",(function(){return Ye})),s.d(i,"UPDATE_NARRATIVE_STEP_IDX",(function(){return Xe})),s.d(i,"updateNarrativeStepIdx",(function(){return Ve})),s.d(i,"UPDATE_SOURCE",(function(){return ze})),s.d(i,"updateSource",(function(){return Be})),s.d(i,"UPDATE_COLORING_SET",(function(){return We})),s.d(i,"updateColoringSet",(function(){return Ke})),s.d(i,"UPDATE_TICKS",(function(){return qe})),s.d(i,"updateTicks",(function(){return Ze})),s.d(i,"TOGGLE_SITES",(function(){return Qe})),s.d(i,"toggleSites",(function(){return Je})),s.d(i,"TOGGLE_FETCHING_DOMAIN",(function(){return et})),s.d(i,"toggleFetchingDomain",(function(){return tt})),s.d(i,"TOGGLE_FETCHING_SOURCES",(function(){return st})),s.d(i,"toggleFetchingSources",(function(){return it})),s.d(i,"TOGGLE_LANGUAGE",(function(){return rt})),s.d(i,"toggleLanguage",(function(){return nt})),s.d(i,"CLOSE_TOOLBAR",(function(){return at})),s.d(i,"closeToolbar",(function(){return ot})),s.d(i,"TOGGLE_INFOPOPUP",(function(){return lt})),s.d(i,"toggleInfoPopup",(function(){return ct})),s.d(i,"TOGGLE_INTROPOPUP",(function(){return dt})),s.d(i,"toggleIntroPopup",(function(){return ut})),s.d(i,"TOGGLE_NOTIFICATIONS",(function(){return pt})),s.d(i,"toggleNotifications",(function(){return ht})),s.d(i,"MARK_NOTIFICATIONS_READ",(function(){return mt})),s.d(i,"markNotificationsRead",(function(){return gt})),s.d(i,"TOGGLE_COVER",(function(){return jt})),s.d(i,"toggleCover",(function(){return bt})),s.d(i,"UPDATE_SEARCH_QUERY",(function(){return ft})),s.d(i,"updateSearchQuery",(function(){return Ot})),s.d(i,"FETCH_SOURCE_ERROR",(function(){return vt})),s.d(i,"fetchSourceError",(function(){return St})),s.d(i,"TOGGLE_SATELLITE_VIEW",(function(){return xt})),s.d(i,"toggleSatelliteView",(function(){return Et})),s.d(i,"REHYDRATE_STATE",(function(){return _t})),s.d(i,"rehydrateState",(function(){return yt}));var r=s(1),n=s.n(r),a=s(190),o=s.n(a),l=s(20),c=s(22),d=s(193),u=s(192),p=s.n(u),h=s(60),m=s.n(h),g=s(18),j=s.n(g),b=s(9);const f={CATEGORY:"CATEGORY",NARRATIVE:"NARRATIVE",FILTER:"FILTER"},O="SHAPE",v="widgets",S="timeline",x="filter_list",E="change_history",_="STAR",y="DIAMOND",T="PENTAGON",C="SQUARE",N="BAR",R="TRIANGLE",A={STAR:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)",DIAMOND:"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)",PENTAGON:"polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%)",TRIANGLE:"polygon(50% 0%, 0% 100%, 100% 100%)"};m.a.extend(p.a);let{DATE_FMT:w,TIME_FMT:k}=Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0});w||(w="MM/DD/YYYY"),k||(k="HH:mm");const I={map:{anchor:[8.130912119045295,-66.63830778451526]}}.language||"en-US";function D(e){const t=e.split("/");return t[t.length-1]}function P(e,t){return[e*Math.cos(2*Math.PI*t),e*Math.sin(2*Math.PI*t)]}function U(e,t){if(e.length<t.length)throw new Error("You must declare an appropriate number of filter colors");return t.reduce(((t,s,i)=>(t[e[i]]=s,t)),{})}function H(e){return e.charAt(0).toUpperCase()+e.slice(1)}function M(e){function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s,...i]=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;const n=Object.keys(e).find((e=>D(e)===s));r.push(s);const a=r.join("/");return n||(e[a]={}),i.length>0&&t(e[a],i,r),e}const s=[];e.forEach((e=>s.push(e.filter_paths)));return s.reduce(((e,s)=>t(e,s,[])),{})}function G(e){const t=e.split("/"),s=[];return t.forEach(((e,i)=>{const r=t.slice(0,i+1).join("/");s.push(r)})),s.pop(),s}function F(e,t){return e.associations.filter((e=>e.mode===f.CATEGORY)).reduce(((e,s)=>{const i=t.find((e=>e===s.title));return i&&e.push(i),e}),[])}function $(e){return e.filter_paths.join("/")}function Y(e){return t=>{let s;return s=t.sources?t.sources.map((t=>e.hasOwnProperty(t)?e[t]:null)):[],{...t,sources:s}}}function X(e){return Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[e]?Array.isArray(Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[e])?Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[e].map((e=>`http://localhost:4040${e}`)):[`http://localhost:4040${Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[e]}`]:null}function V(e){return t=>({...t,flags:{...t.flags,[e]:!t.flags[e]}})}function z(e){let t;switch(e=e.trim(),!0){case/\.((png)|(jpg)|(jpeg))$/.test(e):t="Image";break;case/\.(mp4)$/.test(e):t="Video";break;case/\.(md)$/.test(e):t="Text";break;case/\.(pdf)$/.test(e):t="Document";break;case/.+(twitter\.com).+/.test(e):t="Tweet";break;case/.+(t\.me).+/.test(e):t="Telegram";break;default:t="Unknown"}return t}function B(e,t){return j()(e)===j()(t)}function W(e){return(e>=1?.9:0)+Math.min(.5,.08*(e-1))}function K(e,t){return Math.min(.85,.08+e/t*50)}function q(e,t){const s=t>60?60:35;return Math.min(s,10+e/t*100)}function Z(e){return e.reduce(((e,t)=>(t&&t.properties&&t.properties.cluster&&(e+=t.properties.point_count),e)),0)}function Q(e){return!!e&&isFinite(e)&&Math.abs(e)<=90}function J(e){return!!e&&isFinite(e)&&Math.abs(e)<=180}function ee(e,t){return e.reduce(((e,s)=>{const i=t.find((e=>e.label===s.properties.id));return i&&e.push(i),e}),[])}function te(e,t){if(0===t.length)return[1];const s={};for(const[n,a]of t.entries())for(const e of a)s[e]=n;const i=new Array(t.length);i.fill(0);let r=0;return e.forEach((e=>{let t="events"in e?e.events:e;Array.isArray(t)||(t=[t]),t.forEach((e=>{e.associations.forEach((e=>{const t=s[$(e)];(t||0===t)&&(i[t]+=1,r+=1)}))}))})),0===r?[1]:i.map((e=>e/r))}function se(e,t){let s=-1;return t.map(((t,i)=>(-1!==t.indexOf(e)&&(s=i),null))),s}function ie(e){if(null===e)return null;const t=new Intl.DateTimeFormat(I,{year:"numeric",month:"long",day:"2-digit"}),[{value:s},,{value:i},,{value:r}]=t.formatToParts(e);return`${i} ${s}, ${r}`}const re=e=>0===e.length;const ne=X("EVENTS_EXT"),ae=X("ASSOCIATIONS_EXT"),oe=X("SOURCES_EXT"),le=X("SITES_EXT"),ce=X("REGIONS_EXT"),de=X("SHAPES_EXT"),ue=e=>`Something went wrong fetching ${e}. Check the URL or try disabling them in the config file.`;function pe(){const e=[];function t(t){return e.push({message:t,type:"error"}),[]}return(s,i)=>{const r=i().features;s(tt());const n=Promise.all(ne.map((e=>fetch(e).then((e=>e.json())).catch((()=>t("events")))))).then((e=>e.flatMap((e=>e))));let a=Promise.resolve([]);r.USE_ASSOCIATIONS&&(a=ae?fetch(ae).then((e=>e.json())).catch((()=>t(ue("associations")))):Promise.resolve(t("USE_ASSOCIATIONS is true, but you have not provided a ASSOCIATIONS_EXT")));let o=Promise.resolve([]);r.USE_SOURCES&&(o=oe?fetch(oe).then((e=>e.json())).catch((()=>t(ue("sources")))):Promise.resolve(t("USE_SOURCES is true, but you have not provided a SOURCES_EXT")));let l=Promise.resolve([]);r.USE_SITES&&(l=fetch(le).then((e=>e.json())).catch((()=>t(ue("sites")))));let c=Promise.resolve([]);r.USE_REGIONS&&(c=fetch(ce).then((e=>e.json())).catch((()=>t(ue("regions")))));let d=Promise.resolve([]);return r.USE_SHAPES&&(d=fetch(de).then((e=>e.json())).catch((()=>t(ue("shapes"))))),Promise.all([n,a,o,l,c,d]).then((t=>{const i={events:t[0],associations:t[1],sources:t[2],sites:t[3],regions:t[4],shapes:t[5],notifications:e};if(Object.values(i).some((e=>e.hasOwnProperty("error"))))throw new Error("Some URLs returned negative. If you are in development, check the server is running");return s(tt()),s(De(i.associations)),s(Ue(i.shapes)),i})).catch((e=>{s(me(e.message)),s(tt()),alert(e.message)}))}}const he="FETCH_ERROR";function me(e){return{type:he,message:e}}const ge="UPDATE_DOMAIN";function je(e){return{type:ge,payload:e}}function be(e){return e=>{oe?(e(it()),fetch(`${oe}`).then((e=>{if(e.ok)return e.json();throw new Error("No sources are available at the URL specified in the config specified.")})).catch((t=>{e(St(t.message)),e(it())}))):e(St("No source extension specified."))}}const fe="UPDATE_HIGHLIGHTED";function Oe(e){return{type:fe,highlighted:e}}const ve="UPDATE_SELECTED";function Se(e){return{type:ve,selected:e}}const xe="UPDATE_DISTRICT";function Ee(e){return{type:xe,district:e}}const _e="CLEAR_FILTER";function ye(e){return{type:_e,filter:e}}const Te="TOGGLE_ASSOCIATIONS";function Ce(e,t,s){return{type:Te,association:e,value:t,shouldColor:s}}const Ne="TOGGLE_SHAPES";function Re(e){return{type:Ne,shape:e}}const Ae="SET_LOADING";function we(){return{type:Ae}}const ke="SET_NOT_LOADING";function Ie(){return{type:ke}}const Le="SET_INITIAL_CATEGORIES";function De(e){return{type:Le,values:e}}const Pe="SET_INITIAL_SHAPES";function Ue(e){return{type:Pe,values:e}}const He="UPDATE_TIMERANGE";function Me(e){return{type:He,timerange:e}}const Ge="UPDATE_DIMENSIONS";function Fe(e){return{type:Ge,dims:e}}const $e="UPDATE_NARRATIVE";function Ye(e){return{type:$e,narrative:e}}const Xe="UPDATE_NARRATIVE_STEP_IDX";function Ve(e){return{type:Xe,idx:e}}const ze="UPDATE_SOURCE";function Be(e){return{type:ze,source:e}}const We="UPDATE_COLORING_SET";function Ke(e){return{type:We,coloringSet:e}}const qe="UPDATE_TICKS";function Ze(e){return{type:qe,ticks:e}}const Qe="TOGGLE_SITES";function Je(){return{type:Qe}}const et="TOGGLE_FETCHING_DOMAIN";function tt(){return{type:et}}const st="TOGGLE_FETCHING_SOURCES";function it(){return{type:st}}const rt="TOGGLE_LANGUAGE";function nt(e){return{type:rt,language:e}}const at="CLOSE_TOOLBAR";function ot(){return{type:at}}const lt="TOGGLE_INFOPOPUP";function ct(){return{type:lt}}const dt="TOGGLE_INTROPOPUP";function ut(){return{type:dt}}const pt="TOGGLE_NOTIFICATIONS";function ht(){return{type:pt}}const mt="MARK_NOTIFICATIONS_READ";function gt(){return{type:mt}}const jt="TOGGLE_COVER";function bt(){return{type:jt}}const ft="UPDATE_SEARCH_QUERY";function Ot(e){return{type:ft,searchQuery:e}}const vt="FETCH_SOURCE_ERROR";function St(e){return{type:vt,msg:e}}const xt="TOGGLE_SATELLITE_VIEW";function Et(){return{type:xt}}const _t="REHYDRATE_STATE";function yt(){return{type:_t}}var Tt=s(23);const Ct=e=>e.domain.events,Nt=e=>e.domain.associations.filter((e=>e.mode===f.CATEGORY)),Rt=e=>e.app.associations.narrative,At=e=>e.app.selected,wt=e=>e.domain.sources,kt=e=>e.domain.shapes,It=e=>e.domain.associations.filter((e=>e.mode===f.FILTER)),Lt=e=>e.app.associations.filters,Dt=e=>e.app.associations.categories,Pt=e=>e.app.shapes,Ut=e=>e.app.timeline.range,Ht=e=>e.features,Mt=e=>e.ui.tiles.current,Gt=Object(Tt.createSelector)([e=>e.domain.sites,Ht],((e,t)=>t.USE_SITES?e.filter((e=>!!+e.enabled)):[])),Ft=(Object(Tt.createSelector)([wt,Ht],((e,t)=>t.USE_SOURCES?e:{})),Object(Tt.createSelector)([e=>e.domain.regions,Ht],((e,t)=>t.USE_REGIONS?e:[]))),$t=Object(Tt.createSelector)([Ct,Lt,Dt,Pt,Ut,Ht],((e,t,s,i,r,n)=>e.reduce(((e,a)=>{const o=a.associations&&a.associations.filter((e=>e.mode===f.FILTER)).map((e=>t.includes($(e)))).some((e=>e))||0===t.length||0===t.length,l=a.associations&&a.associations.filter((e=>e.mode===f.CATEGORY)).map((e=>s.includes(e.title))).some((e=>e))||0===s.length;let c=function(e,t){const s=e.datetime;return t[0]<s&&s<t[1]}(a,r);c=n.GRAPH_NONLOCATED&&!a.latitude&&!a.longitude||c;const d=a.shape&&i.includes(a.shape.id);return a.type===O?d&&l&&c&&(e[a.id]={...a}):o&&l&&c&&(e[a.id]={...a}),e}),[]))),Yt=Object(Tt.createSelector)([$t],((e,t)=>e.reduce(((e,t)=>t.latitude&&t.longitude?e+1:e),0))),Xt=Object(Tt.createSelector)([Ct,e=>e.domain.associations.filter((e=>e.mode===f.NARRATIVE)),wt,Ht],((e,t,s,i)=>{if(Array.isArray(t)&&0===t.length)return[];const r={};return e.forEach((e=>{e.associations.forEach((i=>{const n=t.find((e=>e.id===i));if(n){const{id:t}=n;r[t]||(r[t]={id:t,steps:[]}),r[t].steps.push(Y(s)(e))}}))})),Object.keys(r).forEach((e=>{r[e].steps.sort(((e,t)=>e.datetime-t.datetime));const s=t.find((t=>t.id===e));s&&(r[e]={...s,...r[e]})})),t.map((e=>r[e.id])).filter((e=>e))})),Vt=Object(Tt.createSelector)([At,Rt],((e,t)=>{if(null===t)return-1;const s=e[0];let i;return t.steps.forEach(((e,t)=>{s.id===e.id&&(i=t)})),i})),zt=Object(Tt.createSelector)([Rt,Vt],((e,t)=>e?{...e,current:t}:null)),Bt=Object(Tt.createSelector)([$t],(e=>{const t={};return e.forEach((e=>{const{latitude:s,longitude:i}=e;if(!Q(s)||!J(i))return;const r=`${e.location}$_${e.latitude}_${e.longitude}`;t[r]?t[r].events.push(e):t[r]={label:r,events:[e],id:e.id,latitude:e.latitude,longitude:e.longitude}})),Object.values(t)})),Wt=Object(Tt.createSelector)([$t,Ht,e=>e.ui.eventRadius],((e,t,s)=>{if(!t.GRAPH_NONLOCATED)return[e,[]];const i=2*s,r=t.GRAPH_NONLOCATED.projectIdx||0,n={};e=e.reduce(((e,t)=>{const s=t.filters.length>=1&&!t.latitude&&!t.longitude?t.filters[r]:null;return null!==s&&(n.hasOwnProperty(s)?(n[s].start=function(){return Array.prototype.slice.call(arguments).reduce((function(e,t){return e<t?e:t}))}(n[s].start,t.datetime),n[s].end=function(){return Array.prototype.slice.call(arguments).reduce((function(e,t){return e>t?e:t}))}(n[s].end,t.datetime)):n[s]={start:t.datetime,end:t.datetime,key:s,category:t.category}),e.push({...t,project:s}),e}),[]);const a=Object.values(n);a.sort(((e,t)=>e.start-t.start));const o=Object.keys(n).map(((e,t)=>null));return[e,a.reduce(((e,t,s)=>{o.forEach(((e,s)=>{if(null!==e){n[e].end<t.start&&(o[s]=null)}}));let r=0;for(;o[r];)r++;return o[r]=t.key,t.offset=r*i,e[t.key]=t,e}),{})]})),Kt=Object(Tt.createSelector)([Wt],(e=>e[0])),qt=Object(Tt.createSelector)([Wt,Ht],((e,t)=>t.GRAPH_NONLOCATED?e[1]:[])),Zt=Object(Tt.createSelector)([At,wt],((e,t)=>0===e.length?[]:e.map(Y(t)))),Qt=Object(Tt.createSelector)([e=>e.app.timeline.dimensions],(e=>({...e,trackHeight:e.contentHeight-50}))),Jt=Object(Tt.createSelector)([It],(e=>e.reduce(((e,t)=>(e[$(t)]=t.id,e)),{}))),es=Object(Tt.createSelector)([e=>e.app.associations.coloringSet,Jt],((e,t)=>e.map((e=>ss(e,t).join(","))))),ts=Object(Tt.createSelector)([Lt,Jt],((e,t)=>ss(e,t)));function ss(e,t){return e.reduce(((e,s)=>{const i=t[s];return i&&e.push(i),e}),[])}const is={NUMBER:"NUMBER",NUMBER_ARRAY:"NUMBER_ARRAY",STRING:"STRING",STRING_ARRAY:"STRING_ARRAY",DATE:"DATE",DATE_ARRAY:"DATE_ARRAY"};function rs(e){return[is.DATE_ARRAY,is.NUMBER_ARRAY,is.STRING_ARRAY].includes(e.type)}const ns=Object.freeze({id:{key:"id",trigger:ve,type:is.NUMBER_ARRAY,dehydrate:e=>At(e).map((e=>{let{id:t}=e;return t})),rehydrate(e,t){let{id:s}=t;null!==s&&void 0!==s&&s.length&&(e.app.selected=s.map((t=>e.domain.events.find((e=>e.id===t)))))}},range:{key:"range",trigger:He,type:is.DATE_ARRAY,dehydrate:e=>Ut(e),rehydrate(e,t){let{range:s}=t;if(2===(null===s||void 0===s?void 0:s.length)){const t=Array.from(s);t.sort(((e,t)=>new Date(e)-new Date(t))),e.app.timeline.range=t}}},filter:{key:"filter",trigger:Te,type:is.STRING_ARRAY,dehydrate:e=>ts(e),rehydrate(e,t){let{filter:s}=t;if(null!==s&&void 0!==s&&s.length){const t=as(e.domain.associations.filter((e=>e.mode===f.FILTER)));e.app.associations.filters=s.map((e=>t[e]))}}},color:{key:"color",trigger:We,type:is.STRING_ARRAY,dehydrate:e=>es(e),rehydrate(e,t){let{color:s}=t;if(null!==s&&void 0!==s&&s.length){const t=as(e.domain.associations.filter((e=>e.mode===f.FILTER)));e.app.associations.coloringSet=s.map((e=>e.split(",").map((e=>t[e]))))}}}});function as(e){return e.reduce(((e,t)=>(e[t.id]=$(t),e)),{})}var os=class{constructor(){this.url=new URL(window.location),this.schema=ns}delete(e){this.url.searchParams.delete(e)}set(e,t){const s=this.schema[e];if(s)if(this.delete(e),rs(s))t.forEach((t=>{const i=this._encode(s,t);i&&this.url.searchParams.append(e,i)}));else{const i=this._encode(s,t);i&&this.url.searchParams.set(e,i)}}serialize(){window.history.replaceState(null,"",this.url)}deserialize(){const e={};return this.url.searchParams.forEach(((t,s)=>{if(null!=e[s])return;const i=this.schema[s];i&&(e[s]=rs(i)?this.url.searchParams.getAll(s).map((e=>this._decode(i,e))):this._decode(i,this.url.searchParams.get(s)))})),e}_decode(e,t){switch(e.type){case is.NUMBER_ARRAY:case is.NUMBER:return+t;case is.DATE:case is.DATE_ARRAY:return new Date(t);default:if("null"===t||"undefined"===t)return;return t}}_encode(e,t){switch(e.type){case is.NUMBER_ARRAY:case is.NUMBER:return t.toString();case is.DATE:case is.DATE_ARRAY:return m()(t).format("YYYY-MM-DD");default:return t}}};function ls(e){const t=(new os).deserialize();if(null==(s=t)||"object"===typeof s&&!Object.keys(s).length)return e;var s;const i={...e};return Object.values(ns).forEach((e=>{try{e.rehydrate(i,t)}catch(s){console.error(s)}})),i}var cs=s(400);const ds={fa_red:"#eb443e",yellow:"#ffd800",black:"#000",white:"#fff"};var us={fallbackEventColor:ds.fa_red,darkBackground:ds.black,primaryHighlight:ds.fa_red,secondaryHighlight:ds.white},ps=s(8);const hs=window.innerHeight<800,ms={anchor:[8.130912119045295,-66.63830778451526],startZoom:7,minZoom:2,maxZoom:15,bounds:null,maxBounds:[[180,-180],[-180,180]]},gs={},js={domain:{events:[],categories:[],associations:[],sources:{},sites:[],shapes:[],regions:[],notifications:[]},app:{debug:!0,errors:{source:!1},highlighted:null,selected:[],source:null,associations:{coloringSet:[],filters:[],narrative:null,categories:[],views:{events:!0,routes:!1,sites:!0}},shapes:[],isMobile:/Mobi/.test(navigator.userAgent),language:"en-US",cluster:{radius:30,minZoom:2,maxZoom:15},timeline:{dimensions:{ticks:15,height:hs?170:250,width:0,marginLeft:70,marginTop:hs?5:10,marginBottom:60,contentHeight:hs?160:200,width_controls:100},range:[new Date(2024,6,20,12),new Date(2024,8,10,12)],rangeLimits:[new Date(1,1,1,1),new Date],zoomLevels:ps[I].timeline.zoomLevels||[{label:"1 month",duration:40320},{label:"2 weeks",duration:20160},{label:"1 week",duration:10080}]},flags:{isFetchingDomain:!1,isFetchingSources:!1,isCover:!0,isCardstack:!0,isInfopopup:!1,isIntropopup:!1,isShowingSites:!0},cover:{title:"## Election Aftershocks \n\n##### Human Rights violations in Venezuela \n##### 2024",description:"This interactive map designed to visualize human rights violations in Venezuela reported in the period following the 2024 presidential election. The information presented is a compilation of posts published on X (formerly Twitter) by internationally recognized human rights organizations in Venezuela with the understanding that many more violations likely remain unreported.\n\nThe map provides a clear view of the human rights violations, with the approximate location of where they took place based on the content of the post. This resource was designed by anonymous collaborators and researchers who met online with the intention to focus attention on critical human rights issues in the post-electoral context in Venezuela, drawing awareness to specific incidents and the broader human rights environment.<br><br> \n\n##### Contact Information and Acknowledgement \n\n##### To contribute to this project you can visit the [GitHub repo](https://forensic-architecture.org/), which was created using the a template from [Forensic Architecture](https://forensic-architecture.org/). For any info please contact us to 2000mamagallina@gmail.com",exploreButton:"EXPLORE THE MAP"},toolbar:{panels:{categories:{default:{icon:v,label:ps[I].toolbar.categories_label,title:ps[I].toolbar.explore_by_category__title,description:ps[I].toolbar.explore_by_category__description}},filters:{icon:x,label:ps[I].toolbar.filters_label,title:ps[I].toolbar.explore_by_filter__title,description:ps[I].toolbar.explore_by_filter__description},narratives:{icon:S,label:ps[I].toolbar.narratives_label,title:ps[I].toolbar.explore_by_narrative__title,description:ps[I].toolbar.explore_by_narrative__description},shapes:{icon:E,label:ps[I].toolbar.shapes_label,title:ps[I].toolbar.explore_by_shape__title,description:ps[I].toolbar.explore_by_shape__description}}},loading:!1},ui:{tiles:{current:"openstreetmap",default:"openstreetmap"},style:{categories:{default:us.fallbackEventColor},narratives:{default:{opacity:.9,stroke:us.fallbackEventColor,strokeWidth:3}},regions:{default:{stroke:"blue",strokeWidth:3,opacity:.9}},clusters:{radial:!1}},card:{layout:{template:"basic"}},coloring:{maxNumOfColors:4,colors:Object.values(ds)},dom:{timeline:"timeline",timeslider:"timeslider",map:"map"},eventRadius:8},features:{USE_COVER:!0,USE_ASSOCIATIONS:!1,USE_SITES:!1,USE_SOURCES:!1,USE_REGIONS:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}};let bs;bs=Object(cs.a)({app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},js),bs.app.timeline.range[0]=new Date(bs.app.timeline.range[0]),bs.app.timeline.range[1]=new Date(bs.app.timeline.range[1]),bs.app.flags.isIntropopup=!!bs.app.intro,"map"in bs.app&&(bs.app.map=Object(cs.a)(bs.app.map,ms)),"space3d"in bs.app&&(bs.app.space3d=Object(cs.a)(bs.app.space3d,gs));var fs=bs,Os=s(2),vs=s.n(Os);function Ss(e){const t={};return e.forEach((e=>{"text"!==e.kind&&"link"!==e.kind||(t[e.key]=vs.a.string().allow("")),"list"===e.kind&&(t[e.key]=vs.a.array().allow(""))})),t}var xs=function(e){return vs.a.object().keys({id:vs.a.string().allow(""),description:vs.a.string().allow("").required(),date:vs.a.string().allow(""),time:vs.a.string().allow(""),time_precision:vs.a.string().allow(""),location:vs.a.string().allow(""),latitude:vs.a.string().allow(""),longitude:vs.a.string().allow(""),x:vs.a.string().allow(""),y:vs.a.string().allow(""),z:vs.a.string().allow(""),type:vs.a.string().allow(""),category:vs.a.string().allow(""),category_full:vs.a.string().allow(""),associations:vs.a.array().default([]),sources:vs.a.array(),comments:vs.a.string().allow(""),time_display:vs.a.string().allow(""),narrative___stepStyles:vs.a.array(),shape:vs.a.string().allow(""),colour:vs.a.string().allow(""),...Ss(e)}).and("latitude","longitude").or("date","latitude")};var Es=vs.a.object().keys({id:vs.a.string().required(),description:vs.a.string().allow("").required(),site:vs.a.string().required(),latitude:vs.a.string().required(),longitude:vs.a.string().required(),enabled:vs.a.string().allow("")});var _s=vs.a.object().keys({id:vs.a.string().allow("").required(),title:vs.a.string().allow("").required(),desc:vs.a.string().allow(""),mode:vs.a.string().allow("").required(),filter_paths:vs.a.array()});var ys=vs.a.object().keys({id:vs.a.string().required(),title:vs.a.string().allow(""),thumbnail:vs.a.string().allow(""),paths:vs.a.array().required(),type:vs.a.string().allow(""),affil_s:vs.a.array().allow(""),url:vs.a.string().allow(""),description:vs.a.string().allow(""),parent:vs.a.string().allow(""),author:vs.a.string().allow(""),date:vs.a.string().allow(""),notes:vs.a.string().allow("")});var Ts=vs.a.object().keys({name:vs.a.string().required(),items:vs.a.array().required()});var Cs=vs.a.object().keys({id:vs.a.string().allow(""),title:vs.a.string().allow(""),shape:vs.a.string().allow(""),colour:vs.a.string().allow("")});function Ns(e,t,s){return{type:"error",id:t,message:`${e} ${t}: ${s}`}}function Rs(e,t){const s={events:[],sites:[],associations:[],sources:{},regions:[],shapes:[],notifications:e?e.notifications:null};if(void 0===e)return s;const i={events:[],sites:[],associations:[],sources:[],regions:[],shapes:[]};function r(e,t,r){e.forEach((e=>{"events"===t&&""===e.date&&""===e.time||function(e,t,r){const n=vs.a.validate(e,r);if(null!==n.error){const s=e.id||"-",r=Ns(H(t),s,n.error.message);i[t].push(Object.assign(e,{error:r}))}else s[t].push(e)}(e,t,r)}))}Array.isArray(t.CUSTOM_EVENT_FIELDS)||(t.CUSTOM_EVENT_FIELDS=[]);const n=xs(t.CUSTOM_EVENT_FIELDS);var a,o,l;r(e.events,"events",n),r(e.sites,"sites",Es),r(e.associations,"associations",_s),a=e.sources,o="sources",l=ys,Object.keys(a).forEach((e=>{if(""===e)return;const t=a[e],r=vs.a.validate(t,l);if(null!==r.error){const e=t.id||"-",s=H(o);i[o].push({...t,error:Ns(s,e,r.error.message)})}else s[o][e]=t})),r(e.regions,"regions",Ts),r(e.shapes,"shapes",Cs),s.regions=s.regions.map((e=>({name:e.name,points:e.items.map((e=>e.replace(/\s/g,"").split(",")))}))),s.shapes=s.shapes.reduce(((e,t)=>(t.shape?e.push(t):i.shapes.push({...t,error:Ns("events",t.id,"Invalid event shape. Please specify a shape for this type of event.")}),e)),[]);const c=function(e){const t=new Set([]),s=[];return e.forEach((e=>{t.has(e.id)?s.push({id:e.id,error:Ns("Association",e.id,"association was found more than once. Ignoring duplicate.")}):t.add(e.id)})),s}(e.associations);return c.length>0&&s.notifications.push({message:"Associations are required to be unique. Ignoring duplicates for now.",items:c,type:"error"}),s.associations=e.associations,s.events=s.events.filter(((e,t)=>{let r="";if(e.id=t,e.associations=e.associations.reduce(((e,t)=>{const i=s.associations.find((e=>e.id===t));return i&&e.push(i),e}),[]),e.shape){const t=s.shapes.find((t=>t.id===e.shape));t?e.shape=t:r="Failed to find related shape. Please verify shape type for event."}var n,a,o;return e.latitude=e.latitude.replace(",","."),e.longitude=e.longitude.replace(",","."),e.datetime=(n=e.date,(a=e.time)||(a="00:00"),m()(`${n} ${a}`,`${w} ${k}`).toDate()),(o=e.datetime)instanceof Date&&!isNaN(o)||(r="Invalid date. It's been dropped, as otherwise timemap won't work as expected."),!r||(i.events.push({...e,error:Ns("events",e.id,r)}),!1)})),s.events.sort(((e,t)=>e.datetime-t.datetime)),Object.keys(i).forEach((e=>{const t=i[e].length;t&&s.notifications.push({message:`${t} invalid ${e} not displayed.`,items:i[e],type:"error"})})),s}var As=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fs.domain,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ge:return function(e,t){return{...e,...Rs(t.payload.domain,t.payload.features)}}(e,t);case mt:return function(e){return{...e,notifications:e.notifications.map((e=>({...e,isRead:!0})))}}(e);default:return e}};const ws=V("isShowingSites"),ks=V("isFetchingDomain"),Is=V("isFetchingSources"),Ls=V("isInfopopup"),Ds=V("isIntropopup"),Ps=V("isNotification"),Us=V("isCover");var Hs=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fs.app,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe:return function(e,t){return Object.assign({},e,{highlighted:t.highlighted})}(e,t);case ve:return function(e,t){return Object.assign({},e,{selected:t.selected})}(e,t);case We:return function(e,t){return{...e,associations:{...e.associations,coloringSet:t.coloringSet}}}(e,t);case qe:return function(e,t){return{...e,timeline:{...e.timeline,dimensions:{...e.timeline.dimensions,ticks:t.ticks}}}}(e,t);case _e:return function(e,t){return{...e,filters:{...e.filters,[t.filter]:[]}}}(e,t);case Te:return function(e,t){t.value instanceof Array||(t.value=[t.value]);const{association:s}=t;let i=e.associations[s].slice(0);return t.value.forEach((e=>{i.includes(e)?i=i.filter((t=>t!==e)):i.push(e)})),{...e,associations:{...e.associations,[s]:i}}}(e,t);case Ne:return function(e,t){let s=[...e.shapes];if(s.includes(t.shape)){const e=s.indexOf(t.shape);s.splice(e,1)}else s.push(t.shape);return{...e,shapes:s}}(e,t);case He:return function(e,t){return{...e,timeline:{...e.timeline,range:t.timerange}}}(e,t);case Ge:return function(e,t){return{...e,timeline:{...e.timeline,dimensions:{...e.timeline.dimensions,...t.dims}}}}(e,t);case $e:return function(e,t){let s=e.timeline.range[0],i=e.timeline.range[1];const r=[180,180],n=[-180,-180];if(t.narrative){s=e.timeline.rangeLimits[0],i=e.timeline.rangeLimits[1],t.narrative.steps.forEach((e=>{const t=e.datetime;t<s&&(s=t),t>i&&(i=t),e.longitude&&e.latitude&&(+e.longitude<r[1]&&(r[1]=+e.longitude),+e.longitude>n[1]&&(n[1]=+e.longitude),+e.latitude<r[0]&&(r[0]=+e.latitude),+e.latitude>n[0]&&(n[0]=+e.latitude))}));const a=t.narrative.steps[0];if(a.longitude&&a.latitude){const e=Math.abs(+a.longitude-r[1]),t=Math.abs(+a.longitude-n[1]),s=Math.abs(+a.latitude-r[0]),i=Math.abs(+a.latitude-n[0]);e>t&&(n[1]=+a.longitude+e),e<t&&(r[1]=+a.longitude-t),s>i&&(n[0]=+a.latitude+s),s<i&&(r[0]=+a.latitude-i)}s-=Math.abs((i-s)/10),i+=Math.abs((i-s)/10)}return{...e,associations:{...e.associations,narrative:t.narrative},map:{...e.map,bounds:t.narrative?[r,n]:null},timeline:{...e.timeline,range:[s,i]}}}(e,t);case Xe:return function(e,t){return{...e,narrativeState:{current:t.idx}}}(e,t);case ze:return function(e,t){return{...e,source:t.source}}(e,t);case rt:return function(e,t){const s="es-MX"===e.language?"en-US":"es-MX";return Object.assign({},e,{language:t.language||s})}(e,t);case Qe:return ws(e);case et:return ks(e);case st:return Is(e);case lt:return Ls(e);case dt:return Ds(e);case pt:return Ps(e);case jt:return Us(e);case he:return function(e,t){return{...e,error:t.message,notifications:[{type:"error",message:t.message}]}}(e,t);case vt:return function(e,t){return{...e,errors:{...e.errors,source:t.msg}}}(e,t);case Ae:return function(e){return{...e,loading:!0}}(e);case ke:return function(e){return{...e,loading:!1}}(e);case Le:return function(e,t){const s=t.values.reduce(((e,t)=>(t.mode===f.CATEGORY&&e.push(t.title),e)),[]);return{...e,associations:{...e.associations,categories:s}}}(e,t);case Pe:return function(e,t){return{...e,shapes:t.values.map((e=>e.id))}}(e,t);case ft:return function(e,t){return{...e,searchQuery:t.searchQuery}}(e,t);default:return e}};var Ms=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fs.ui;return(arguments.length>1?arguments[1]:void 0).type===xt?{...e,tiles:{...e.tiles,current:"satellite"===e.tiles.current?e.tiles.default:"satellite"}}:e};var Gs=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fs.features;return e};var Fs=function(e,t){return(s,i)=>t({...e(s,i)},i)}((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(arguments.length>1?arguments[1]:void 0).type===_t?ls(e):e}),Object(c.combineReducers)({app:Hs,domain:As,ui:Ms,features:Gs}));const $s=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.compose;var Ys=Object(c.createStore)(Fs,$s(Object(c.applyMiddleware)(d.a),Object(c.applyMiddleware)((function(e){return t=>s=>{const i=t(s);try{const t=Object.values(ns).filter((e=>e.trigger===s.type));if(t.length){const s=new os,i=e.getState();t.forEach((e=>{s.set(e.key,e.dehydrate(i))})),s.serialize()}}catch(r){console.error("error serializing url state",r)}return i}})))),Xs=(s(369),s(194)),Vs=s(41),zs=s(0);var Bs=e=>{let{label:t,isActive:s,onClickCheckbox:i,color:r,styleProps:n}=e;const a=r||"#ffffff",o={checkboxStyles:{background:s?a:"none",border:`1px solid ${a}`}},l=n?n.containerStyles:{},c=n?n.checkboxStyles:o.checkboxStyles;return Object(zs.jsxs)("div",{className:s?"item active":"item",children:[Object(zs.jsx)("span",{style:{color:r},children:t}),Object(zs.jsx)("button",{onClick:i,children:Object(zs.jsx)("div",{className:"border",style:l,children:Object(zs.jsx)("div",{className:"checkbox",style:c})})})]})},Ws=s(21);function Ks(e,t){const[s,i]=e;if(i==={})return[s];const r=t.includes(s),n=Object.entries(i).flatMap((e=>Ks(e,t))).filter((e=>t.includes(e)===r));return n.push(s),n}var qs=function(e){let{filters:t,activeFilters:s,onSelectFilter:i,language:r,coloringSet:n,filterColors:a,title:o,description:l}=e;function c(e,t){const[r,o]=e,l=D(r),d=Ks(e,s),u=se(r,n),p=-1!==u&&s.includes(r)?a[u]:"",h={color:p,marginLeft:20*t+"px"};return Object(zs.jsxs)("li",{className:"filter-filter",style:{...h},children:[Object(zs.jsx)(Bs,{label:l,isActive:s.includes(r),onClickCheckbox:()=>i(r,d),color:p}),Object.keys(o).length>0?Object(zs.jsx)("ul",{children:Object.entries(o).map((e=>c(e,t+1)))}):null]},l.replace(/ /g,"_"))}return Object(zs.jsxs)("div",{className:"react-innertabpanel",children:[Object(zs.jsx)("h2",{children:o}),Object(zs.jsx)("p",{dangerouslySetInnerHTML:{__html:Object(Ws.marked)(l)}}),function(e){const t=M(e);return Object(zs.jsx)("div",{children:Object.entries(t).map((e=>c(e,1)))})}(t)]})};var Zs=e=>{let{data:t,activeValues:s,onSelect:i,type:r}=e;const n=r===f.CATEGORY?"title":"id";return Object(zs.jsx)("div",{children:t.map((e=>Object(zs.jsx)("li",{className:"filter-filter active",style:{marginLeft:"20px"},children:Object(zs.jsx)(Bs,{label:e.title,isActive:s.includes(e[n]),onClickCheckbox:()=>i(e[n]),styleProps:e.styles})},e.title.replace(/ /g,"_"))))})};var Qs=e=>{let{categories:t,activeCategories:s,onCategoryFilter:i,language:r,title:n,description:a}=e;return Object(zs.jsxs)("div",{className:"react-innertabpanel",children:[Object(zs.jsx)("h2",{children:n}),Object(zs.jsx)("p",{dangerouslySetInnerHTML:{__html:Object(Ws.marked)(a)}}),Object(zs.jsx)(Zs,{data:t,activeValues:s,onSelect:i,type:f.CATEGORY})]})};var Js=e=>{let{shapes:t,activeShapes:s,onShapeFilter:i,language:r,title:n,description:a}=e;const o=function(e,t){return e.map((e=>{const{colour:s,shape:i,id:r}=e,n={checkboxStyles:{background:t.includes(r)?s:"black",border:"none",clipPath:A[i]},containerStyles:{background:s,clipPath:A[i]}};return e.styles=n,e}))}(t,s);return Object(zs.jsxs)("div",{className:"react-innertabpanel",children:[Object(zs.jsx)("h2",{children:n}),Object(zs.jsx)("p",{dangerouslySetInnerHTML:{__html:Object(Ws.marked)(a)}}),Object(zs.jsx)(Zs,{data:o,activeValues:s,onSelect:i,type:O})]})};var ei=e=>{let{isActive:t,isDisabled:s,onClickHandler:i}=e,r=t?"action-button enabled":"action-button";return s&&(r="action-button disabled"),Object(zs.jsx)("button",{className:r,onClick:i,children:Object(zs.jsx)("i",{className:"material-icons",children:"location_on"})})};var ti=e=>{let{isActive:t,isDisabled:s,onClickHandler:i}=e,r=t?"action-button enabled":"action-button";return s&&(r="action-button disabled"),Object(zs.jsx)("button",{className:r,onClick:i,children:Object(zs.jsx)("i",{className:"material-icons",children:"home"})})};var si=e=>{let{isActive:t,isDisabled:s,onClickHandler:i}=e,r=t?"action-button enabled":"action-button";return s&&(r="action-button disabled"),Object(zs.jsx)("button",{className:r,onClick:i,children:Object(zs.jsx)("i",{className:"material-icons",children:"info"})})};var ii=function(e){return Object(zs.jsx)("div",{className:"bottom-actions",children:Object(zs.jsxs)(zs.Fragment,{children:[Object(zs.jsx)("div",{className:"bottom-action-block",children:e.features.USE_SITES?Object(zs.jsx)(ei,{isActive:e.sites.enabled,onClickHandler:e.sites.toggle}):null}),Object(zs.jsx)("div",{className:"botttom-action-block",children:Object(zs.jsx)(si,{isActive:e.info.enabled,onClickHandler:e.info.toggle})}),Object(zs.jsx)("div",{className:"botttom-action-block",children:e.features.USE_COVER?Object(zs.jsx)(ti,{onClickHandler:e.cover.toggle}):null})]})})};function ri(e){let{isActive:t,iconKey:s,onClick:i,label:r}=e;return Object(zs.jsxs)("div",{className:t?"toolbar-tab active":"toolbar-tab",onClick:i,children:[Object(zs.jsx)("i",{className:"material-icons",children:s}),Object(zs.jsx)("div",{className:"tab-caption",children:r})]},s)}ri.tabsRole="Tab";var ni=s(40),ai=s.n(ni);class oi extends n.a.Component{constructor(e){super(e),this.onFullscreenStateChange=this.onFullscreenStateChange.bind(this),this.state={isFullscreen:ai.a.isFullscreen}}componentDidMount(){ai.a.on("change",this.onFullscreenStateChange)}componentWillUnmount(){ai.a.off("change",this.onFullscreenStateChange)}onFullscreenStateChange(e){this.setState({isFullscreen:ai.a.isFullscreen})}onToggleFullscreen(){ai.a.toggle().catch(console.warn)}render(){if(!ai.a.isEnabled)return null;const{language:e}=this.props,{isFullscreen:t}=this.state;return Object(zs.jsx)(ri,{isActive:t,label:t?ps[e].toolbar.fullscreen_exit:ps[e].toolbar.fullscreen_enter,iconKey:t?"fullscreen_exit":"fullscreen",onClick:this.onToggleFullscreen})}}class li extends n.a.Component{constructor(e){super(e),this.onSelectFilter=this.onSelectFilter.bind(this),this.state={_selected:-1}}selectTab(e){const t=this.state._selected===e?-1:e;this.setState({_selected:t})}onSelectFilter(e,t){const{filters:s,activeFilters:i,coloringSet:r,maxNumOfColors:n}=this.props,a=function(e){const t=G(e);return t[t.length-1]}(e);if(i.includes(e)){if(a&&i.includes(a)){const r=function(e,t,s){const i=function e(t,s){if(0===s.length||t==={})return{};const i=s.shift();if(Object.keys(t).includes(i)){const r=t[i];return 0===s.length?r:e(r,s)}}(M(e),G(s));return Object.keys(i).filter((e=>e!==s))}(s,0,e);let n=!0;for(const e of r)if(i.includes(e)){n=!1;break}if(n){const s=G(e).filter((e=>i.includes(e)));t=t.concat(s)}}const n=function(e,t){return e.map((e=>e.filter((e=>!t.includes(e))))).filter((e=>0!==e.length))}(r,t);this.props.actions.updateColoringSet(n)}else{const e=function(e,t){const s=e.flatMap((e=>e)),i=t.filter((e=>-1===s.indexOf(e)));return[...e,i]}(r,t);e.length<=n&&this.props.actions.updateColoringSet(e)}this.props.methods.onSelectFilter(t),this.props.actions.updateSelected([])}renderClosePanel(){return Object(zs.jsx)("div",{className:"panel-header",onClick:()=>this.selectTab(-1),children:Object(zs.jsx)("div",{className:"caret"})})}goToNarrative(e){this.selectTab(-1),this.props.methods.onSelectNarrative(e)}renderToolbarNarrativePanel(){const{panels:e}=this.props.toolbarCopy;return Object(zs.jsxs)(Vs.b,{children:[Object(zs.jsx)("h2",{children:e.narratives.label}),Object(zs.jsx)("p",{children:e.narratives.description}),this.props.narratives.map((e=>{return Object(zs.jsx)("div",{className:"panel-action action",children:Object(zs.jsxs)("button",{onClick:()=>{this.goToNarrative(e)},children:[Object(zs.jsx)("p",{children:e.id}),Object(zs.jsx)("p",{children:Object(zs.jsx)("small",{children:(t=e.desc,s=120,t.length>s?t.substring(0,120)+"...":t)})})]})});var t,s}))]})}renderToolbarCategoriesPanel(){const{categories:e}=this.props.toolbarCopy.panels,t=function(e,t){const s=e.reduce(((e,t)=>{const s=t.filter_paths[0];return s in e||(e[s]=[]),e[s].push(t),e}),{});return t.length>1?s:{default:e}}(this.props.categories,Object.keys(e));return Object(zs.jsx)("div",{children:Object.keys(t).map((s=>{const i=t[s];return Object(zs.jsx)(Vs.b,{children:Object(zs.jsx)(Qs,{categories:i,activeCategories:this.props.activeCategories,onCategoryFilter:this.props.methods.onCategoryFilter,language:this.props.language,title:e[s].label,description:e[s].description})},s)}))})}renderToolbarFilterPanel(){const{panels:e}=this.props.toolbarCopy;return Object(zs.jsx)(Vs.b,{children:Object(zs.jsx)(qs,{filters:this.props.filters,activeFilters:this.props.activeFilters,onSelectFilter:this.onSelectFilter,language:this.props.language,coloringSet:this.props.coloringSet,filterColors:this.props.filterColors,title:e.filters.label,description:e.filters.description})})}renderToolbarShapePanel(){const{panels:e}=this.props.toolbarCopy;if(this.props.features.USE_SHAPES)return Object(zs.jsx)(Vs.b,{children:Object(zs.jsx)(Js,{shapes:this.props.shapes,activeShapes:this.props.activeShapes,onShapeFilter:this.props.methods.onShapeFilter,language:this.props.language,title:e.shapes.label,description:e.shapes.description})})}renderToolbarTab(e,t,s,i){return Object(zs.jsx)(ri,{label:t,iconKey:s,isActive:this.state._selected===e,onClick:()=>{this.selectTab(e)}},i)}renderToolbarCategoryTabs(e){const{categories:t}=this.props.toolbarCopy.panels;return Object(zs.jsx)("div",{children:Object.keys(e).map((s=>this.renderToolbarTab(e[s],t[s].label,t[s].icon,s)))})}renderToolbarPanels(){const{features:e,narratives:t}=this.props,s=this.state._selected>=0?"toolbar-panels":"toolbar-panels folded";return Object(zs.jsxs)("div",{className:s,children:[this.renderClosePanel(),t&&0!==t.length?this.renderToolbarNarrativePanel():null,e.USE_CATEGORIES?this.renderToolbarCategoriesPanel():null,e.USE_ASSOCIATIONS?this.renderToolbarFilterPanel():null,e.USE_SHAPES?this.renderToolbarShapePanel():null]})}renderToolbarNavs(){return this.props.narratives?this.props.narratives.map(((e,t)=>{const s=t===this.state._selected?"toolbar-tab active":"toolbar-tab";return Object(zs.jsx)("div",{className:s,onClick:()=>{this.selectTab(t)},children:Object(zs.jsx)("div",{className:"tab-caption",children:e.label})})})):null}renderToolbarTabs(){const{features:e,narratives:t,toolbarCopy:s}=this.props,i=t&&0!==t.length;let r=ps[this.props.language].toolbar.title;r="example";const{panels:n}=s,a=function(e,t){let s=t;return(e.length>1?e.filter((e=>"default"!==e)):e).reduce(((e,t)=>(e[t]=s,s+=1,e)),{})}(Object.keys(n.categories),i?1:0),o=Object.keys(a).length,l=function(e,t,s){return e&&!t?1:!e&&t?s:e&&t?s+1:0}(i,e.USE_CATEGORIES,o||0),c=l+1;return Object(zs.jsxs)("div",{className:"toolbar",children:[Object(zs.jsx)("div",{className:"toolbar-header",onClick:this.props.methods.onTitle,children:Object(zs.jsx)("p",{children:"Election Aftershocks: Human Rights violations in Venezuela"})}),Object(zs.jsx)("div",{className:"toolbar-tabs",children:Object(zs.jsxs)(Vs.a,{children:[i?this.renderToolbarTab(0,n.narratives.label,n.narratives.icon):null,e.USE_CATEGORIES?this.renderToolbarCategoryTabs(a):null,e.USE_ASSOCIATIONS?this.renderToolbarTab(l,n.filters.label,n.filters.icon):null,e.USE_SHAPES?this.renderToolbarTab(c,n.shapes.label,n.shapes.icon):null,e.USE_FULLSCREEN&&Object(zs.jsx)(oi,{language:this.props.language})]})}),Object(zs.jsx)(ii,{info:{enabled:this.props.infoShowing,toggle:this.props.actions.toggleInfoPopup},sites:{enabled:this.props.sitesShowing,toggle:this.props.actions.toggleSites},cover:{toggle:this.props.actions.toggleCover},features:this.props.features})]})}render(){const{isNarrative:e}=this.props;return Object(zs.jsx)("div",{id:"toolbar-wrapper",className:"toolbar-wrapper "+(e?"narrative-mode":""),children:Object(zs.jsxs)(Vs.c,{onSelect:()=>null,selectedIndex:this.state._selected,children:[this.renderToolbarTabs(),this.renderToolbarPanels()]})})}}var ci=Object(l.b)((function(e){return{filters:It(e),categories:Nt(e),narratives:Xt(e),shapes:kt(e),language:e.app.language,toolbarCopy:e.app.toolbar,activeFilters:Lt(e),activeCategories:Dt(e),activeShapes:Pt(e),viewFilters:e.app.associations.views,narrative:e.app.associations.narrative,sitesShowing:e.app.flags.isShowingSites,infoShowing:e.app.flags.isInfopopup,coloringSet:e.app.associations.coloringSet,maxNumOfColors:e.ui.coloring.maxNumOfColors,filterColors:e.ui.coloring.colors,eventRadius:e.ui.eventRadius,features:Ht(e)}}),(function(e){return{actions:Object(c.bindActionCreators)(i,e)}}))(li);const di=window.innerWidth>1e3?14:18;var ui=e=>{let{content:t=[],styles:s={},isOpen:i=!0,onClose:r,title:n,theme:a="light",isMobile:o=!1,children:l}=e;return Object(zs.jsx)("div",{children:Object(zs.jsxs)("div",{className:`infopopup ${i?"":"hidden"} ${"dark"===a?"dark":"light"} ${o?"mobile":""}`,style:{...s,fontSize:di},children:[Object(zs.jsxs)("div",{className:"legend-header",children:[Object(zs.jsx)("button",{onClick:r,className:"side-menu-burg over-white is-active",children:Object(zs.jsx)("span",{})}),Object(zs.jsx)("h2",{children:n})]}),t.map(((e,t)=>Object(zs.jsx)("div",{dangerouslySetInnerHTML:{__html:Object(Ws.marked)(e)}},t))),l]})})};var pi=e=>{let{isOpen:t,onClose:s,language:i,styles:r}=e;return Object(zs.jsx)(ui,{title:ps[i].legend.default.header,content:ps[i].legend.default.intro,onClose:s,isOpen:t,styles:r})};class hi extends n.a.Component{constructor(e){super(),this.state={isExtended:!1}}toggleDetails(){this.setState({isExtended:!this.state.isExtended})}renderItems(e){return e?Object(zs.jsx)("div",{children:e.map(((e,t)=>e.error?Object(zs.jsx)("p",{children:e.error.message},t):null))}):""}renderNotificationContent(e){const{type:t,message:s,items:i}=e;return Object(zs.jsxs)("div",{children:[Object(zs.jsx)("div",{className:`message ${t}`,children:s}),Object(zs.jsx)("div",{className:`details ${this.state.isExtended}`,children:null!==i?this.renderItems(i):""})]})}render(){if(!this.props.notifications)return null;return this.props.notifications.filter((e=>!("isRead"in e&&e.isRead))).length>0?Object(zs.jsx)("div",{className:"notification-wrapper",children:this.props.notifications.map(((e,t)=>Object(zs.jsxs)("div",{className:"notification",onClick:()=>this.toggleDetails(),children:[Object(zs.jsx)("button",{onClick:this.props.onToggle,className:"side-menu-burg over-white is-active",children:Object(zs.jsx)("span",{})}),this.renderNotificationContent(e)]},t)))}):Object(zs.jsx)("div",{})}}var mi=s(73),gi=s(195),ji=s.n(gi);class bi extends n.a.Component{constructor(e){super(e),this.state={md:null,error:null}}componentDidMount(){fetch(this.props.path).then((e=>e.text())).then((e=>{if(e.length<=0)throw new Error;this.setState({md:Object(Ws.marked)(e)})})).catch((()=>{this.setState({error:!0})}))}render(){return this.state.md&&!this.state.error?Object(zs.jsx)("div",{className:"md-container",dangerouslySetInnerHTML:{__html:this.state.md}}):this.state.error?this.props.unloader||Object(zs.jsx)("div",{children:"Error: couldn't load source"}):this.props.loader}}var fi=bi;var Oi=e=>{let{small:t}=e;return Object(zs.jsxs)("div",{className:"spinner "+(t?"small":""),children:[Object(zs.jsx)("div",{className:"double-bounce-overlay"}),Object(zs.jsx)("div",{className:"double-bounce"})]})};var vi=e=>{let{failedUrls:t}=e;return Object(zs.jsx)("div",{className:"no-source-container",children:Object(zs.jsxs)("div",{className:"no-source-row",children:[Object(zs.jsx)("p",{children:Object(zs.jsx)("i",{className:"material-icons no-source-icon",children:"error"})}),Object(zs.jsx)("p",{children:"No media found, as the original media has not yet been uploaded to the platform."})]})})};var Si=e=>{let{media:t,viewIdx:s,translations:i,switchLanguage:r,langIdx:n}=e;const a=document.querySelector(".source-media-gallery"),o=a?a.getBoundingClientRect().width:0;return Object(zs.jsx)("div",{className:"source-media-gallery",style:{transform:`translate(${s*-o}px)`},children:t.map((e=>function(e){const{path:t,type:s,poster:a}=e;switch(s){case"Image":return Object(zs.jsx)("div",{className:"source-image-container",children:Object(zs.jsx)(ji.a,{className:"source-image",src:t,loader:Object(zs.jsx)("div",{className:"source-image-loader",children:Object(zs.jsx)(Oi,{})}),unloader:Object(zs.jsx)(vi,{failedUrls:[t]}),onClick:()=>window.open(t,"_blank")})});case"Video":return Object(zs.jsxs)("div",{className:"media-player",children:[Object(zs.jsx)("div",{className:"banner-trans right-overlay",children:i?i.map(((e,t)=>n!==t+1?Object(zs.jsx)("div",{className:"trans-button",onClick:()=>r(t+1),children:e.code}):Object(zs.jsx)("div",{className:"trans-button",onClick:()=>r(0),children:"EN"}))):null}),Object(zs.jsx)(mi.Player,{poster:a,className:"source-video",playsInline:!0,src:t})]});case"Text":return Object(zs.jsx)("div",{className:"source-text-container",children:Object(zs.jsx)(fi,{path:t,loader:Object(zs.jsx)(Oi,{}),unloader:()=>this.renderError()})});case"Document":return Object(zs.jsx)("iframe",{title:t,className:"source-document",src:t});default:return Object(zs.jsx)(vi,{failedUrls:[`Application does not support extension: ${t.split(".")[1]}`]})}}(e)))})};var xi=e=>{let{viewIdx:t,paths:s,onShiftHandler:i}=e;const r=0!==t?Object(zs.jsx)("div",{className:"back",onClick:()=>i(-1),children:Object(zs.jsx)("div",{className:"centerer",children:Object(zs.jsx)("i",{className:"material-icons",children:"arrow_left"})})}):null,n=t<s.length-1?Object(zs.jsx)("div",{className:"next",onClick:()=>i(1),children:Object(zs.jsx)("div",{className:"centerer",children:Object(zs.jsx)("i",{className:"material-icons",children:"arrow_right"})})}):null;return s.length>1?Object(zs.jsxs)("div",{className:"media-gallery-controls",children:[r,n]}):Object(zs.jsx)("div",{className:"media-gallery-controls"})};class Ei extends n.a.Component{constructor(){super(),this.state={mediaIdx:0,langIdx:0},this.onShiftGallery=this.onShiftGallery.bind(this)}getTypeCounts(e){return e.reduce(((e,t)=>(e[t.type]+=1,e)),{Image:0,Video:0,Text:0})}onShiftGallery(e){0===this.state.mediaIdx&&-1===e||this.state.mediaIdx===this.props.source.paths.length-1&&1===e||this.setState({mediaIdx:this.state.mediaIdx+e})}switchLanguage(e){this.setState({langIdx:e})}renderContent(e){const{url:t,title:s,paths:i,date:r,type:n,poster:a,description:o}=e,l=s.substring(0,100);return Object(zs.jsxs)(zs.Fragment,{children:[Object(zs.jsxs)("div",{className:"mo-banner",children:[Object(zs.jsx)("div",{className:"mo-banner-close",onClick:this.props.onCancel,children:Object(zs.jsx)("i",{className:"material-icons",children:"close"})}),Object(zs.jsx)("h3",{className:"mo-banner-content",children:l})]}),Object(zs.jsx)("div",{className:"mo-container",onClick:e=>e.stopPropagation(),children:Object(zs.jsx)("div",{className:"mo-media-container",children:Object(zs.jsx)(Si,{switchLanguage:e=>this.switchLanguage(e),translations:this.props.translations,langIdx:this.state.langIdx,media:i.map((e=>function(e,t){return{type:z(e),path:e,poster:t}}(e,a))),viewIdx:this.state.mediaIdx})})}),Object(zs.jsxs)("div",{className:"mo-footer",children:[Object(zs.jsx)(xi,{paths:i,viewIdx:this.state.mediaIdx,onShiftHandler:this.onShiftGallery}),Object(zs.jsxs)("div",{className:"mo-meta-container",children:[o?Object(zs.jsx)("div",{className:"mo-box-desc",children:Object(zs.jsx)("div",{className:"md-container",dangerouslySetInnerHTML:{__html:Object(Ws.marked)(o)}})}):null,n||r||t?Object(zs.jsxs)("div",{className:"mo-box",children:[Object(zs.jsxs)("div",{children:[n?Object(zs.jsx)("h4",{children:"Evidence type"}):null,n?Object(zs.jsxs)("p",{children:[Object(zs.jsx)("i",{className:"material-icons left",children:"perm_media"}),n]}):null]}),Object(zs.jsxs)("div",{children:[r?Object(zs.jsx)("h4",{children:"Date Published"}):null,r?Object(zs.jsxs)("p",{children:[Object(zs.jsx)("i",{className:"material-icons left",children:"today"}),r]}):null]}),Object(zs.jsxs)("div",{children:[t?Object(zs.jsx)("h4",{children:"Link"}):null,t?Object(zs.jsxs)("span",{children:[Object(zs.jsx)("i",{className:"material-icons left",children:"link"}),Object(zs.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:"Link to original URL"})]}):null]})]}):null]})]})]})}renderIntlContent(){const{langIdx:e}=this.state,{translations:t,source:s}=this.props;let i=null;return t&&t.length&&e>0&&(i=t[e-1]),i&&(i={...i,poster:s.poster,paths:i.file?[i.file]:i.paths}),this.renderContent(0===e?s:i)}render(){return"object"!==typeof this.props.source?this.renderError():Object(zs.jsx)("div",{className:"mo-overlay "+(this.props.opaque?"opaque":""),children:this.renderIntlContent()})}}var _i=Ei,yi=s.p+"static/media/github-white.4d74fd76.png";class Ti extends n.a.Component{constructor(e){super(e),this.state={video:-2,featureLang:0}}getVideo(e,t){return e<t?this.props.cover.headerVideos[e]:e>=0?this.props.cover.videos[e-t]:null}onVideoClickHandler(e){const t=this.props.cover.headerVideos?this.props.cover.headerVideos.length:0;return()=>{this.setState({video:e+t})}}renderFeature(){const{featureVideo:e}=this.props.cover,{featureLang:t}=this.state,{translations:s}=e,i=0===t?e:{...s[t-1],poster:e.poster};return Object(zs.jsxs)("div",{children:[Object(zs.jsx)("div",{className:"banner-trans right-overlay",children:s&&s.map(((e,s)=>{const i=s+1;return t!==i?Object(zs.jsx)("div",{onClick:()=>this.setState({featureLang:i}),className:"trans-button",children:e.code},e.code):Object(zs.jsx)("div",{onClick:()=>this.setState({featureLang:0}),className:"trans-button",children:"ENG"},"ENG")}))}),Object(zs.jsx)(mi.Player,{className:"source-video",poster:i.poster,playsInline:!0,src:i.file})]})}renderHeaderVideos(){const{headerVideos:e}=this.props.cover;return Object(zs.jsx)("div",{className:"row",children:e.slice(0,2).map(((e,t)=>Object(zs.jsx)("div",{className:"cell plain",onClick:()=>this.setState({video:t}),children:e.buttonTitle},t)))})}renderButton(e,t){return Object(zs.jsx)("div",{className:"row",children:Object(zs.jsx)("a",{className:"cell "+(t?"yellow":"plain"),href:e.href,children:e.title})})}renderMediaOverlay(){const e=this.getVideo(this.state.video,this.props.cover.headerVideos?this.props.cover.headerVideos.length:0);return Object(zs.jsx)(_i,{opaque:!0,source:{title:e.title,desc:e.desc,paths:[e.file],poster:e.poster},translations:e.translations,onCancel:()=>this.setState({video:-2})})}render(){if(!this.props.cover)return Object(zs.jsxs)("div",{className:"default-cover-container",children:["You haven't specified any cover props. Put them in the values that overwrite the store in ",Object(zs.jsx)("code",{children:"app.cover"})]});const{videos:e,footerButton:t}=this.props.cover,{showing:s}=this.props;return Object(zs.jsxs)("div",{className:"default-cover-container",children:[Object(zs.jsxs)("div",{className:s?"cover-header":"cover-header minimized",children:[Object(zs.jsx)("a",{className:"cover-logo-container",href:"https://forensic-architecture.org"}),Object(zs.jsx)("a",{className:"cover-logo-container",href:"https://github.com/mamagallina",children:Object(zs.jsx)("img",{className:"cover-logo",src:yi,alt:"Github"})})]}),Object(zs.jsxs)("div",{className:"cover-content",children:[this.props.cover.bgVideo?Object(zs.jsx)("div",{className:"fullscreen-bg "+(this.props.showing?"":"hidden"),children:Object(zs.jsx)("video",{loop:!0,muted:!0,autoPlay:!0,preload:"auto",className:"fullscreen-bg__video",children:Object(zs.jsx)("source",{src:this.props.cover.bgVideo,type:"video/mp4"})})}):null,Object(zs.jsx)("h2",{style:{margin:0},dangerouslySetInnerHTML:{__html:Object(Ws.marked)(this.props.cover.title)}}),this.props.cover.subtitle?Object(zs.jsx)("h3",{style:{marginTop:0},children:this.props.cover.subtitle}):null,this.props.cover.subsubtitle?Object(zs.jsx)("h5",{children:this.props.cover.subsubtitle}):null,this.props.cover.featureVideo?this.renderFeature():null,Object(zs.jsxs)("div",{className:"hero thin",children:[this.props.cover.headerVideos?this.renderHeaderVideos():null,this.props.cover.headerButton?this.renderButton(this.props.cover.headerButton):null,Object(zs.jsx)("div",{className:"row",children:Object(zs.jsx)("div",{className:"cell yellow",onClick:this.props.showAppHandler,children:this.props.cover.exploreButton})})]}),Array.isArray(this.props.cover.description)?this.props.cover.description.map(((e,t)=>Object(zs.jsx)("div",{className:"md-container",dangerouslySetInnerHTML:{__html:Object(Ws.marked)(e)}},t))):Object(zs.jsx)("div",{className:"md-container",dangerouslySetInnerHTML:{__html:Object(Ws.marked)(this.props.cover.description)}}),e?Object(zs.jsxs)("div",{className:"hero",children:[Object(zs.jsx)("div",{className:"row",children:e&&e.slice(0,2).map(((e,t)=>Object(zs.jsxs)("div",{className:"cell small",onClick:this.onVideoClickHandler(t),children:[e.buttonTitle,Object(zs.jsx)("br",{}),e.buttonSubtitle]},t)))}),Object(zs.jsx)("div",{className:"row",children:e.length>2&&this.props.cover.videos.slice(2,4).map(((e,t)=>Object(zs.jsxs)("div",{className:"cell small",onClick:this.onVideoClickHandler(t+2),children:[e.buttonTitle,Object(zs.jsx)("br",{}),e.buttonSubtitle]},t)))})]}):null,t?Object(zs.jsx)("div",{className:"hero",children:Object(zs.jsx)("div",{className:"row",children:this.renderButton(t)})}):null]}),-2!==this.state.video?this.renderMediaOverlay():null]})}}var Ci=Object(l.b)((function(e){return{cover:e.app.cover}}))(Ti);var Ni=e=>{let{showing:t,children:s}=e;return Object(zs.jsx)("div",{className:"cover-container "+(t?"showing":""),children:s})};var Ri=e=>{let{isLoading:t,language:s}=e,i="loading-overlay";return i+=t?"":" hidden",Object(zs.jsx)("div",{id:"loading-overlay",className:i,children:Object(zs.jsxs)("div",{className:"loading-wrapper",children:[Object(zs.jsx)("span",{id:"loading-text",className:"text",children:ps[s].loading}),Object(zs.jsxs)("div",{className:"spinner",children:[Object(zs.jsx)("div",{className:"double-bounce1"}),Object(zs.jsx)("div",{className:"double-bounce2"})]})]})})};var Ai=e=>{let{title:t,from:s,to:i,onClick:r,hideInfo:n}=e;const a=s&&ie(s),o=i&&ie(i);return Object(zs.jsxs)("div",{className:"timeline-header",children:[Object(zs.jsx)("div",{className:"timeline-toggle",onClick:()=>r(),children:Object(zs.jsx)("p",{children:Object(zs.jsx)("i",{className:"arrow-down"})})}),Object(zs.jsxs)("div",{className:"timeline-info "+(n?"hidden":""),children:[Object(zs.jsx)("p",{children:t}),Object(zs.jsxs)("p",{children:[a," - ",o]})]})]})};!function(){const e={"es-MX":s(238)};"es-US"!==I&&e[I]&&Object(b.f)(e[I])}();class wi extends n.a.Component{constructor(){super(),this.xAxis0Ref=n.a.createRef(),this.xAxis1Ref=n.a.createRef(),this.state={isInitialized:!1}}componentDidUpdate(){let e,t;this.props.extent>5256e3?(e="%Y",t=""):(this.props.extent,t="%d %b",e="");const{marginTop:s,contentHeight:i}=this.props.dims;this.props.scaleX&&(this.x0=Object(b.a)(this.props.scaleX).ticks(this.props.ticks).tickPadding(0).tickSize(i-15-s).tickFormat(Object(b.e)(e)),this.x1=Object(b.a)(this.props.scaleX).ticks(this.props.ticks).tickPadding(s).tickSize(0).tickFormat(Object(b.e)(t)),this.state.isInitialized||this.setState({isInitialized:!0})),this.state.isInitialized&&(Object(b.d)(this.xAxis0Ref.current).transition().duration(this.props.transitionDuration).call(this.x0),Object(b.d)(this.xAxis1Ref.current).transition().duration(this.props.transitionDuration).call(this.x1))}render(){return Object(zs.jsxs)(zs.Fragment,{children:[Object(zs.jsx)("g",{ref:this.xAxis0Ref,transform:`translate(0, ${this.props.dims.marginTop})`,clipPath:"url(#clip)",className:"axis xAxis"}),Object(zs.jsx)("g",{ref:this.xAxis1Ref,transform:`translate(0, ${this.props.dims.marginTop})`,clipPath:"url(#clip)",className:"axis xAxis"})]})}}var ki=wi;var Ii=e=>{let{dims:t}=e;return Object(zs.jsx)("clipPath",{id:"clip",children:Object(zs.jsx)("rect",{x:t.marginLeft,y:"0",width:Math.max(0,t.width-t.marginLeft-t.width_controls),height:t.contentHeight})})};var Li=e=>{let{dims:t,onMoveTime:s}=e;const i="scale(1.5,1.5)",r=t.contentHeight/2;return Object(zs.jsxs)("g",{className:"time-controls-inline",children:[Object(zs.jsxs)("g",{transform:`translate(${t.marginLeft-20}, ${r})`,onClick:()=>s("backwards"),children:[Object(zs.jsx)("circle",{r:45}),Object(zs.jsx)("path",{d:"M0,-7.847549217020565L6.796176979388489,3.9237746085102825L-6.796176979388489,3.9237746085102825Z",transform:`rotate(270) ${i}`})]}),Object(zs.jsxs)("g",{transform:`translate(${t.width-t.width_controls+20}, ${r})`,onClick:()=>s("forward"),children:[Object(zs.jsx)("circle",{r:45}),Object(zs.jsx)("path",{d:"M0,-7.847549217020565L6.796176979388489,3.9237746085102825L-6.796176979388489,3.9237746085102825Z",transform:`rotate(90) ${i}`})]})]})};const Di=[{label:"20 years",duration:10512e3},{label:"2 years",duration:1051200},{label:"3 months",duration:129600},{label:"3 days",duration:4320},{label:"12 hours",duration:720},{label:"1 hour",duration:60}];var Pi=e=>{let{extent:t,zoomLevels:s,dims:i,onApplyZoom:r}=e;return 0===s.length&&(s=Di),Object(zs.jsx)("g",{transform:`translate(${i.width-i.width_controls}, 0)`,children:s.map(((e,i)=>function(e,i){const n=s.reduce(((e,t)=>e.duration<t.duration?t:e)),a=function(e,t,s){return e>=s&&t>=s||e===t}(e.duration,t,n.duration);return Object(zs.jsx)("text",{className:"zoom-level-button "+(a?"active":""),x:"60",y:15*i+20,onClick:()=>r(e),children:e.label},i)}(e,i)))})};var Ui=e=>{let{styles:t,eventRadius:s,getEventX:i,getEventY:r,categories:n,transitionDuration:a,selected:o,dims:l,features:c}=e;return Object(zs.jsx)("g",{clipPath:"url(#clip)",children:o.reduce((function(e,o){function d(e){return Object(zs.jsx)("circle",{className:"timeline-marker",cx:0,cy:0,stroke:t?t.stroke:us.primaryHighlight,strokeOpacity:"1",strokeWidth:t?t["stroke-width"]:1,strokeLinejoin:"round",strokeDasharray:t?t["stroke-dasharray"]:"2,2",style:{transform:`translate(${i(o)}px, ${e}px)`,WebkitTransition:`transform ${a/1e3}s ease`,MozTransition:"none",opacity:1},r:2*s},j()(o))}function u(){return Object(zs.jsx)("rect",{className:"timeline-marker",x:0,y:l.marginTop,width:s/1.5,height:l.contentHeight-55,stroke:t?t.stroke:us.primaryHighlight,strokeOpacity:"1",strokeWidth:t?t["stroke-width"]:1,strokeDasharray:t?t["stroke-dasharray"]:"2,2",style:{transform:`translate(${i(o)}px)`,opacity:.7}})}const p=Q(o.latitude)&&J(o.longitude)||c.GRAPH_NONLOCATED&&-1!==o.projectOffset,h=F(o,n).map((e=>r({...o,category:e})));function m(t){switch(o.shape){case"circle":case y:case _:e.push(d(t));break;case N:e.push(u());break;default:return p?e.push(d(t)):e.push(u())}}return h.length>0?h.forEach(m):m(r(o)),e}),[])})};var Hi=e=>{let{highlights:t,events:s,x:i,y:r,width:n,height:a,onSelect:o,styleProps:l,extraRender:c}=e;if(0===t.length)return Object(zs.jsx)("rect",{onClick:o,className:"event",x:i,y:r,style:l,width:n,height:a});const d=a/t.length;return Object(zs.jsx)(zs.Fragment,{children:t.map(((e,t)=>Object(zs.jsx)("rect",{onClick:o,className:"event",x:i,y:r-d+t*d+d/2,style:{...l,opacity:e?.3:.1},width:n,height:d})))})};var Mi=e=>{let{x:t,y:s,r:i,transform:r,onSelect:n,styleProps:a,extraRender:o}=e;const l=i/2;return Object(zs.jsx)("rect",{onClick:n,className:"event",x:t-l,y:s,style:a,width:i,height:i,transform:r})};function Gi(e,t,s,i){const r=t,n=2*t/e,a=Math.PI/e,o=[];for(let l=0;l<2*e;l++){const e=l%2!==0?r:n;o.push(e*Math.sin(l*a)+s),o.push(e*Math.cos(l*a)+i)}return o}var Fi=e=>{let{x:t,y:s,r:i,onSelect:r,styleProps:n,extraRender:a}=e;return Object(zs.jsx)("polygon",{onClick:r,className:"event",x:t,y:s,style:n,points:Gi(5,i,t,s)})};var $i=e=>{let{x:t,y:s,r:i,transform:r,onSelect:n,styleProps:a}=e;const o=2*i/3;return Object(zs.jsx)("polygon",{onClick:n,className:"event",x:t,y:s,style:a,points:`${t},${s+o} ${t+o},${s-o} ${t-o},${s-o}`,transform:`rotate(180, ${t}, ${s})`})};var Yi=e=>{let{x:t,y:s,r:i,transform:r,onSelect:n,styleProps:a}=e;const o=2*i/3;return Object(zs.jsx)("polygon",{onClick:n,className:"event",x:t,y:s,style:a,points:`${t},${s+o} ${t+o},${s} ${t+o},${s-o} ${t-o},${s-o} ${t-o},${s}`,transform:`rotate(180, ${t}, ${s})`})};var Xi=e=>{let{offset:t,id:s,start:i,end:r,getX:n,y:a,dims:o,colour:l,eventRadius:c,onClick:d}=e;const u=n(r)-n(i);return void 0===t?null:Object(zs.jsx)("rect",{onClick:d,className:"project",x:n(i),y:o.marginTop+t,width:u,style:{fill:l,fillOpacity:.2},height:2*c})};var Vi=function(e){let{radius:t,colorPercentMap:s,styles:i,className:r}=e,n=0;const a=Object.keys(s);return Object(zs.jsx)(zs.Fragment,{children:a.map(((e,o)=>{const l=s[e],[c,d]=P(t,n);n+=l;const[u,p]=P(t,n),h=1===a.length||l>.5?1:0,m=[`M ${c} ${d}`,`A ${t} ${t} 0 ${h} 1 ${u} ${p}`,"L 0 0 ",`L ${c} ${d} Z`].join(" "),g={...i,fill:e};return Object(zs.jsx)("path",{className:r,id:`arc_${o}`,d:m,style:g},`arc_${o}`)}))})};function zi(e,t,s){const i=te([e],s.coloringSet);return Object(zs.jsx)("g",{className:"timeline-event",onClick:s.onSelect,transform:`translate(${s.x}, ${s.y})`,children:Object(zs.jsx)(Vi,{radius:s.eventRadius,colorPercentMap:U(s.filterColors,i),styles:{...t},className:"event"})},e.id)}function Bi(e,t,s){const i=s.features.GRAPH_NONLOCATED?e.projectOffset>=0?t.opacity:.5:W(1);return Object(zs.jsx)(Hi,{onSelect:s.onSelect,category:e.category,events:[e],x:s.x,y:s.dims.marginTop,width:s.eventRadius/4,height:s.dims.trackHeight,styleProps:{...t,fillOpacity:i},highlights:s.highlights})}function Wi(e,t,s){return Object(zs.jsx)(Mi,{onSelect:s.onSelect,x:s.x,y:s.y-s.eventRadius,r:1.8*s.eventRadius,styleProps:t,transform:`rotate(45, ${s.x}, ${s.y})`})}function Ki(e,t,s){return Object(zs.jsx)(Mi,{onSelect:s.onSelect,x:s.x,y:s.y-1.8*s.eventRadius/2,r:1.8*s.eventRadius,styleProps:t})}function qi(e,t,s){return Object(zs.jsx)($i,{onSelect:s.onSelect,x:s.x,y:s.y,r:1.5*s.eventRadius,styleProps:t})}function Zi(e,t,s){return Object(zs.jsx)(Yi,{onSelect:s.onSelect,x:s.x,y:s.y,r:1.5*s.eventRadius,styleProps:t})}function Qi(e,t,s){return Object(zs.jsx)(Fi,{onSelect:s.onSelect,x:s.x,y:s.y,r:1.5*s.eventRadius,styleProps:{...t,fillRule:"nonzero"}})}var Ji=e=>{let{events:t,projects:s,categories:i,narrative:r,getDatetimeX:n,getY:a,getCategoryColor:o,getHighlights:l,onSelect:c,transitionDuration:d,dims:u,features:p,setLoading:h,setNotLoading:m,eventRadius:g,filterColors:j,coloringSet:b}=e;const f=r?r.steps.map((e=>e.id)):[];let O=()=>null;return p.GRAPH_NONLOCATED&&(O=function(){return Object(zs.jsx)(zs.Fragment,{children:Object.values(s).map((e=>Object(zs.jsx)(Xi,{...e,eventRadius:g,onClick:()=>console.log(e),getX:n,dims:u,colour:o(e.category)},e.id)))})}),Object(zs.jsxs)("g",{clipPath:"url(#clip)",children:[O(),t.reduce((function(e,t){if(r&&!f.includes(t.id))return null;const s=Q(t.latitude)&&J(t.longitude)||p.GRAPH_NONLOCATED&&-1!==t.projectOffset,{shape:h}=t;let m=s?zi:Bi;h&&h.shape&&(m=h.shape===N?Bi:h.shape===y?Wi:h.shape===_?Qi:h.shape===R?qi:h.shape===T?Zi:h.shape===C?Ki:zi);const O=F(t,i).map((e=>{const s=a({...t,category:e});return{y:s,styles:{fill:t.colour?t.colour:o(e.title),fillOpacity:s>0?W(1):0,transition:`transform ${d/1e3}s ease`}}}));function v(e,s){return m(t,s,{x:n(t.datetime),y:e,eventRadius:g,onSelect:()=>c(t),dims:u,highlights:p.HIGHLIGHT_GROUPS?l(t.filters[p.HIGHLIGHT_GROUPS.filterIndexIndicatingGroup]):[],features:p,filterColors:j,coloringSet:b})}return 0===O.length?e.push(v(a(t),{fill:o(null)})):O.forEach((t=>{e.push(v(t.y,t.styles))})),e}),[])]})};class er extends n.a.Component{constructor(e){super(e),this.grabRef=n.a.createRef(),this.state={isInitialized:!1}}componentDidUpdate(){if(!this.state.isInitialized){const e=Object(b.b)().on("start",this.props.onDragStart).on("drag",this.props.onDrag).on("end",this.props.onDragEnd);Object(b.d)(this.grabRef.current).call(e),this.setState({isInitialized:!0})}}renderCategory(e,t){const{features:s,dims:i}=this.props;return s.GRAPH_NONLOCATED&&s.GRAPH_NONLOCATED.categories&&s.GRAPH_NONLOCATED.categories.includes(e)?null:Object(zs.jsxs)(zs.Fragment,{children:[Object(zs.jsx)("g",{className:"tick",style:{strokeWidth:1},opacity:"0.5",transform:`translate(0,${this.props.getCategoryY(e)})`,children:Object(zs.jsx)("line",{x1:i.marginLeft,x2:i.width-i.width_controls})}),Object(zs.jsx)("g",{className:"tick",opacity:"1",transform:`translate(0,${this.props.getCategoryY(e)})`,children:Object(zs.jsx)("text",{x:i.marginLeft-5,dy:"0.32em",children:e})})]})}render(){const{dims:e,categories:t,fallbackLabel:s}=this.props,i=t&&t.length>0?t.map(((e,t)=>this.renderCategory(e,t))):this.renderCategory(s,0);return Object(zs.jsxs)("g",{className:"yAxis",children:[i,Object(zs.jsx)("rect",{ref:this.grabRef,className:"drag-grabber",x:e.marginLeft,y:e.marginTop,width:Math.max(0,e.width-e.marginLeft-e.width_controls),height:e.contentHeight})]})}}var tr=er;class sr extends n.a.Component{constructor(e){super(e),this.styleDatetime=this.styleDatetime.bind(this),this.getDatetimeX=this.getDatetimeX.bind(this),this.getY=this.getY.bind(this),this.onApplyZoom=this.onApplyZoom.bind(this),this.onSelect=this.onSelect.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.svgRef=n.a.createRef(),this.state={isFolded:!1,dims:e.dimensions,scaleX:null,scaleY:null,timerange:[null,null],dragPos0:null,transitionDuration:300}}componentDidMount(){this.addEventListeners()}UNSAFE_componentWillReceiveProps(e){if(j()(e)!==j()(this.props)&&this.setState({timerange:e.app.timeline.range,scaleX:this.makeScaleX()}),j()(e.activeCategories)!==j()(this.props.activeCategories)||j()(e.dimensions)!==j()(this.props.dimensions)){const{trackHeight:t,marginTop:s}=e.dimensions;this.setState({scaleY:this.makeScaleY(e.activeCategories,t,s)})}e.dimensions.trackHeight!==this.props.dimensions.trackHeight&&this.computeDims()}addEventListeners(){window.addEventListener("resize",(()=>{this.computeDims()}));const e=document.querySelector(".timeline-wrapper");null!==e&&e.addEventListener("transitionend",(e=>{this.computeDims()}))}makeScaleX(){return Object(b.c)().domain(this.state.timerange).range([this.state.dims.marginLeft,this.state.dims.width-this.state.dims.width_controls])}makeScaleY(e,t,s){const{features:i}=this.props;i.GRAPH_NONLOCATED&&i.GRAPH_NONLOCATED.categories&&(e=e.filter((e=>!i.GRAPH_NONLOCATED.categories.includes(e.title))));const r=e.length>2?t/e.length:t/(e.length+1),n=e.map(((e,t)=>(t+1)*r+s+0));return t=>{const s=e.indexOf(t);return n[s]}}componentDidUpdate(e,t){t.timerange!==this.state.timerange&&this.setState({scaleX:this.makeScaleX()})}getTimeScaleExtent(){if(!this.state.scaleX)return 0;const e=this.state.scaleX.domain();return(e[1].getTime()-e[0].getTime())/6e4}onClickArrow(){this.setState((e=>({isFolded:!e.isFolded})))}computeDims(){const e=this.props.ui.dom.timeline;if(null!==document.querySelector(`#${e}`)){const t=document.querySelector(`#${e}`).getBoundingClientRect();this.setState({dims:{...this.props.dimensions,width:t.width}},(()=>{this.setState({scaleX:this.makeScaleX()})}))}}onMoveTime(e){const t=this.getTimeScaleExtent(),s=b.g.offset(this.state.scaleX.domain()[0],t);let i=s,r=b.g.offset(s,t);"backwards"===e&&(i=b.g.offset(s,-2*t),r=b.g.offset(s,-t)),this.props.methods.onUpdateTimerange([i,r]),this.props.methods.onSelect([])}onCenterTime(e){const t=this.getTimeScaleExtent(),s=b.g.offset(e,-t/2),i=b.g.offset(e,+t/2);this.setState({timerange:[s,i]},(()=>{this.props.methods.onUpdateTimerange(this.state.timerange)}))}onSoftTimeRangeUpdate(e){this.setState({timerange:e})}onApplyZoom(e){const t=this.getTimeScaleExtent(),s=b.g.offset(this.state.scaleX.domain()[0],t/2),{rangeLimits:i}=this.props.app.timeline;let r=b.g.offset(s,-e.duration/2),n=b.g.offset(s,e.duration/2);if(i){const t=i[0],s=i[1];r<t&&(r=t,n=b.g.offset(r,e.duration)),n>s&&(n=s,r=b.g.offset(n,-e.duration))}this.setState({timerange:[r,n]},(()=>{this.props.actions.updateTicks(15),this.props.methods.onUpdateTimerange(this.state.timerange)}))}toggleTransition(e){this.setState({transitionDuration:e?300:0})}onDragStart(e){e.sourceEvent.stopPropagation(),this.setState({dragPos0:e.x},(()=>{this.toggleTransition(!1)}))}onDrag(e){const t=(this.state.scaleX.invert(this.state.dragPos0).getTime()-this.state.scaleX.invert(e.x).getTime())/1e3,{range:s,rangeLimits:i}=this.props.app.timeline;let r=b.h.offset(s[0],t),n=b.h.offset(s[1],t);if(i){const e=i[0],t=i[1];r=r<e?e:r,n=n>t?t:n}this.onSoftTimeRangeUpdate([r,n])}onDragEnd(){this.toggleTransition(!0),this.props.methods.onUpdateTimerange(this.state.timerange)}getDatetimeX(e){return this.state.scaleX(e)}getY(e){const{features:t,domain:s,activeCategories:i}=this.props,{USE_CATEGORIES:r,GRAPH_NONLOCATED:n}=t;if(!(r&&i&&i.length>0))return this.state.dims.trackHeight/1.5;const{category:a}=e;if(n&&n.categories.includes(a)){const{project:t}=e;return this.state.dims.marginTop+s.projects[t].offset+this.props.ui.eventRadius}return this.state.scaleY?this.state.scaleY(a):0}styleDatetime(e,t){return[null,null]}onSelect(e){if(this.props.features.ZOOM_TO_TIMEFRAME_ON_TIMELINE_CLICK){const t=Math.floor(this.props.features.ZOOM_TO_TIMEFRAME_ON_TIMELINE_CLICK/2),s=b.g.offset(e.datetime,-t),i=b.g.offset(e.datetime,t);this.props.actions.updateTicks(1),this.props.methods.onUpdateTimerange([s,i])}this.props.methods.onSelect(e)}render(){const{isNarrative:e,app:t,domain:s}=this.props;let i="timeline-wrapper "+(this.state.isFolded?" folded":"");i+=null!==t.narrative?" narrative-mode":"";const{dims:r}=this.state,n={bottom:this.state.isFolded?-r.height:0,left:110},a={height:r.height},o={...a,...n},l={height:r.contentHeight},{activeCategories:c}=this.props,d=ps[this.props.app.language].timeline.info.replace("%n",s.eventCountInTimeRange);return Object(zs.jsxs)("div",{className:i,style:o,onKeyDown:this.props.onKeyDown,tabIndex:"1",children:[Object(zs.jsx)(Ai,{title:d,from:this.state.timerange[0],to:this.state.timerange[1],onClick:()=>{this.onClickArrow()},hideInfo:e}),Object(zs.jsx)("div",{className:"timeline-content",style:a,children:Object(zs.jsx)("div",{id:this.props.ui.dom.timeline,className:"timeline",style:l,children:Object(zs.jsxs)("svg",{ref:this.svgRef,width:r.width,style:l,children:[Object(zs.jsx)(Ii,{dims:r}),Object(zs.jsx)(ki,{ticks:t.timeline.dimensions.ticks,dims:r,extent:this.getTimeScaleExtent(),transitionDuration:this.state.transitionDuration,scaleX:this.state.scaleX}),Object(zs.jsx)(tr,{dims:r,getCategoryY:e=>this.getY({category:e,project:null}),onDragStart:this.onDragStart,onDrag:this.onDrag,onDragEnd:this.onDragEnd,categories:c,features:this.props.features,fallbackLabel:ps[this.props.app.language].timeline.default_categories_label}),1===t.timeline.dimensions.ticks&&Object(zs.jsx)(Li,{dims:r,onMoveTime:e=>{this.onMoveTime(e)}}),Object(zs.jsx)(Pi,{extent:this.getTimeScaleExtent(),zoomLevels:this.props.app.timeline.zoomLevels,dims:r,onApplyZoom:this.onApplyZoom}),Object(zs.jsx)(Ui,{dims:r,selected:this.props.app.selected,getEventX:e=>this.getDatetimeX(e.datetime),getEventY:this.getY,categories:c,transitionDuration:this.state.transitionDuration,styles:this.props.ui.styles,features:this.props.features,eventRadius:this.props.ui.eventRadius}),Object(zs.jsx)(Ji,{events:this.props.domain.events,projects:this.props.domain.projects,categories:c,styleDatetime:this.styleDatetime,narrative:this.props.app.narrative,getDatetimeX:this.getDatetimeX,getY:this.getY,getHighlights:e=>"None"===e?[]:c.map((t=>t.group===e)),getCategoryColor:this.props.methods.getCategoryColor,transitionDuration:this.state.transitionDuration,onSelect:this.onSelect,dims:r,features:this.props.features,setLoading:this.props.actions.setLoading,setNotLoading:this.props.actions.setNotLoading,eventRadius:this.props.ui.eventRadius,filterColors:this.props.ui.filterColors,coloringSet:this.props.app.coloringSet})]})})})]})}}var ir=Object(l.b)((function(e){return{dimensions:Qt(e),isNarrative:!!e.app.associations.narrative,activeCategories:Dt(e),domain:{events:Kt(e),eventCountInTimeRange:Yt(e),projects:qt(e),narratives:e.domain.narratives},app:{selected:e.app.selected,language:e.app.language,timeline:e.app.timeline,narrative:e.app.associations.narrative,coloringSet:e.app.associations.coloringSet},ui:{dom:e.ui.dom,styles:e.ui.style.selectedEvents,eventRadius:e.ui.eventRadius,filterColors:e.ui.coloring.colors},features:Ht(e)}}),(function(e){return{actions:Object(c.bindActionCreators)({setLoading:we,setNotLoading:Ie,updateTicks:Ze},e)}}))(sr),rr=(s(397),s(25)),nr=s(401),ar=s(197);var or=function(e){let{sites:t,projectPoint:s}=e;return t&&t.length?Object(zs.jsx)("div",{className:"sites-layer",children:t.map((function(e){const{x:t,y:i}=s([e.latitude,e.longitude]);return Object(zs.jsx)("div",{className:"leaflet-tooltip site-label leaflet-zoom-animated leaflet-tooltip-top",style:{opacity:1,transform:`translate3d(calc(${t}px - 50%), ${i-25}px, 0px)`},children:e.site})}))}):null};var lr=function(e){let{svg:t,regions:s,projectPoint:i,styles:r}=e;return s&&s.length?Object(zs.jsx)(nr.a,{node:t,children:Object(zs.jsx)("g",{id:"regions-layer",className:"narrative",children:s.map((function(e){const t=[],s=e.points.map(i);return s.forEach(((i,r)=>{if(r<e.points.length-1){const e=s[r+1];t.push({x1:i.x,y1:i.y,x2:e.x,y2:e.y})}})),t.map((t=>{const s=e.name in r?r[e.name]:r.default;return Object(zs.jsx)("line",{id:`${e.name}_style`,markerStart:"none",...t,style:s})}))}))})}):null};var cr=function(e){let{getCategoryColor:t,categories:s,projectPoint:i,styleLocation:r,selected:n,narrative:a,onSelect:o,svg:l,locations:c,eventRadius:d,coloringSet:u,filterColors:p,features:h}=e;function m(e){const t=te([e],u),s={stroke:us.darkBackground,strokeWidth:0,fillOpacity:a?1:W(e.events.length)};return Object(zs.jsx)(Vi,{radius:d,colorPercentMap:U(p,t),styles:{...s},className:"location-event-marker"})}return Object(zs.jsx)(nr.a,{node:l,children:Object(zs.jsx)("svg",{children:Object(zs.jsx)("g",{className:"event-locations",children:c.map((function(e){if(!e.latitude||!e.longitude)return null;const{x:t,y:s}=i([e.latitude,e.longitude]);if(a){const{steps:t}=a,s=e=>t.map((e=>e.id)).includes(e.id);if(e.events.filter(s).length<=0)return null}const l=r?r(e):null,c=()=>Object(zs.jsx)(zs.Fragment,{children:l[1]}),d=n.reduce(((t,s)=>t||s.latitude===e.latitude&&s.longitude===e.longitude),!1);return Object(zs.jsx)("svg",{children:Object(zs.jsxs)("g",{className:"location-event "+(a?"no-hover":""),transform:`translate(${t}, ${s})`,onClick:t=>function(e,t){const s=e.shiftKey?n.concat(t.events):t.events;o(s)}(t,e),children:[m(e),c?c():null,Object(zs.jsx)("circle",{className:"event-hover",display:d?"auto":"none",cx:"0",cy:"0",r:"10",stroke:us.primaryHighlight,fillOpacity:"0.0"})]})},j()(e))}))})})})};const dr=()=>Object(zs.jsx)("defs",{children:Object(zs.jsxs)("radialGradient",{id:"clusterGradient",children:[Object(zs.jsx)("stop",{offset:"10%","stop-color":"red"}),Object(zs.jsx)("stop",{offset:"90%","stop-color":"transparent"})]})});function ur(e){let{cluster:t,size:s,projectPoint:i,totalPoints:n,styles:a,renderHover:o,onClick:l,getClusterChildren:c,coloringSet:d,filterColors:u}=e;const{cluster_id:p}=t.properties,h=te(c(p),d),{coordinates:m}=t.geometry,[g,j]=m,{x:b,y:f}=i([j,g]),[O,v]=Object(r.useState)(!1);return Q(j)&&J(g)?Object(zs.jsx)("svg",{children:Object(zs.jsxs)("g",{className:"cluster-event",transform:`translate(${b}, ${f})`,onClick:e=>l({id:p,latitude:j,longitude:g}),onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[Object(zs.jsx)(Vi,{radius:s,colorPercentMap:U(u,h),styles:{...a},className:"cluster-event-marker"}),O?o(t):null]})}):null}var pr=function(e){let{projectPoint:t,onSelect:s,getClusterChildren:i,coloringSet:r,isRadial:n,svg:a,clusters:o,filterColors:l,selected:c}=e;const d=Z(o),u={fill:n?"url('#clusterGradient')":us.fallbackEventColor,stroke:us.darkBackground,strokeWidth:0};return Object(zs.jsx)(nr.a,{node:a,children:Object(zs.jsx)("svg",{children:Object(zs.jsxs)("g",{className:"cluster-locations",children:[n?Object(zs.jsx)(dr,{}):null,o.map(((e,n)=>{const a=e.properties.point_count,o=q(a,d);return Object(zs.jsx)(ur,{onClick:s,getClusterChildren:i,coloringSet:r,cluster:e,filterColors:l,size:o,projectPoint:t,totalPoints:d,styles:{...u,fillOpacity:K(a,d)},renderHover:()=>{return e=a,t=o,Object(zs.jsxs)(zs.Fragment,{children:[Object(zs.jsx)("text",{textAnchor:"middle",y:"3px",style:{fontWeight:"bold",fill:"black",zIndex:1e4},children:e}),Object(zs.jsx)("circle",{className:"event-hover",cx:"0",cy:"0",r:t+2,stroke:us.primaryHighlight,fillOpacity:"0.0"})]});var e,t}},n)}))]})})})};class hr extends n.a.Component{renderMarker(e){const{x:t,y:s}=this.props.projectPoint([e.latitude,e.longitude]),i=this.props.styles,r=e.radius?e.radius+5:24;return Object(zs.jsx)("g",{className:"location-marker",transform:`translate(${t-r}, ${s})`,children:Object(zs.jsx)("path",{className:"leaflet-interactive",stroke:i?i.stroke:us.primaryHighlight,strokeOpacity:"1",strokeWidth:i?i["stroke-width"]:2,strokeLinecap:"",strokeLinejoin:"round",strokeDasharray:i?i["stroke-dasharray"]:"2,2",fill:"none",d:`M0,0a${r},${r} 0 1,0 ${2*r},0 a${r},${r} 0 1,0 -${2*r},0 `})},j()(e))}render(){return Object(zs.jsx)(nr.a,{node:this.props.svg,children:this.props.selected.map((e=>this.renderMarker(e)))})}}var mr=hr;const gr={strokeOpacity:1,strokeWidth:0,strokeDasharray:"none",stroke:"none"};var jr=function(e){let{styles:t,onSelectNarrative:s,svg:i,narrative:r,narratives:n,projectPoint:a,features:o}=e;const l=n&&0!==n.length;function c(e){return""===e.latitude||""===e.longitude}function d(e,t,s){const i=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),r=Math.atan2(t.y-e.y,t.x-e.x),n=Math.atan2(1,2),a=i<24?i/2:24,o=t.x-a*Math.cos(r),l=t.y-a*Math.sin(r),c=o-10*Math.cos(-r-n),d=l+10*Math.sin(-r-n),u=o-10*Math.cos(-r+n),p=l+10*Math.sin(-r+n);return Object(zs.jsx)("path",{className:"narrative-step-arrow",d:`\n        M ${o} ${l}\n        L ${c} ${d}\n        L ${u} ${p} Z\n      `,style:{...s,fillOpacity:s.strokeOpacity,fill:s.stroke}})}function u(e,t,i){if(c(e)||c(t))return null;if(!e||!t)return null;return function(e,t,i){const{stroke:r,strokeWidth:n,strokeDasharray:a,strokeOpacity:o}=i;return Object(zs.jsxs)("g",{children:[Object(zs.jsx)("line",{className:"narrative-step",x1:e.x,x2:t.x,y1:e.y,y2:t.y,markerStart:"none",onClick:e=>s(e),style:{strokeWidth:n,strokeDasharray:a,strokeOpacity:o,stroke:r}}),"none"!==r?d(e,t,i):""]})}(a([e.latitude,e.longitude]),a([t.latitude,t.longitude]),{...gr,...i||{}})}function p(e){if(null===e||e.id!==r.id)return null;const s=[];let i=null;if(l)for(let t=0;t<e.steps.length;t+=1){const r=e.steps[t];i&&s.push(u(i,r,e.withLines?{strokeWidth:"1px",stroke:r.colour}:{})),i=r}else for(let r=0;r<e.steps.length;r+=1){const n=e.steps[r],a=n.narratives.indexOf(e.id),o=n.narrative___stepStyles[a];"None"!==o&&(i&&s.push(u(i,n,t.stepStyles[o])),i=n)}return s}return null===r?null:Object(zs.jsx)(nr.a,{node:i,children:Object(zs.jsx)("g",{className:"narratives",children:n.map((function(e){const s=`narrative-${e.id.replace(/ /g,"_")}`,i=l||o.NARRATIVE_STEP_STYLES?p(e):function(e){if(null===e||e.id!==r.id)return null;const s=[];for(let r=0;r<e.steps.length-1;r+=1){const n=e.steps[r],a=e.steps[r+1];s.push(u(n,a,(i=e.id,t[i&&i in t?i:"default"])))}var i;return s}(e);return Object(zs.jsx)("g",{id:s,className:"narrative",children:i})}))})})};var br=()=>Object(zs.jsx)("svg",{children:Object(zs.jsxs)("defs",{children:[Object(zs.jsx)("marker",{id:"arrow",viewBox:"0 0 6 6",refX:"3",refY:"3",markerWidth:"6",markerHeight:"6",orient:"auto",children:Object(zs.jsx)("path",{d:"M0,3v-3l6,3l-6,3z",style:{fill:"red"}})}),Object(zs.jsx)("marker",{id:"arrow-off",viewBox:"0 0 6 6",refX:"3",refY:"3",markerWidth:"6",markerHeight:"6",orient:"auto",children:Object(zs.jsx)("path",{d:"M0,3v-3l6,3l-6,3z",style:{fill:"black",fillOpacity:.2}})})]})}),fr=s.p+"static/media/map.1a1ec3b3.png",Or=s.p+"static/media/sat.751acac8.png";var vr=e=>{let{switchToSatellite:t,reset:s,isUsingSatellite:i}=e;return Object(zs.jsx)("div",{id:"satellite-overlay-toggle",className:"satellite-overlay-toggle",children:i?Object(zs.jsx)("button",{className:"satellite-overlay-toggle-button satellite-overlay-toggle-map",style:{backgroundImage:`url(${fr}`},onClick:s,children:Object(zs.jsx)("div",{className:"label",children:ps[I].tiles.default})}):Object(zs.jsx)("button",{className:"satellite-overlay-toggle-button satellite-overlay-toggle-sat",style:{backgroundImage:`url(${Or}`},onClick:t,children:Object(zs.jsx)("div",{className:"label",children:ps[I].tiles.satellite})})})};const Sr=["streets-v11","satellite"];class xr extends n.a.Component{constructor(){super(),this.projectPoint=this.projectPoint.bind(this),this.onClusterSelect=this.onClusterSelect.bind(this),this.loadClusterData=this.loadClusterData.bind(this),this.getClusterChildren=this.getClusterChildren.bind(this),this.svgRef=n.a.createRef(),this.map=null,this.superclusterIndex=null,this.tileLayer=null,this.state={mapTransformX:0,mapTransformY:0,indexLoaded:!1,clusters:[]},this.styleLocation=this.styleLocation.bind(this)}componentDidMount(){null===this.map&&(this.initializeMap(),this.initializeTileLayer()),window.dispatchEvent(new Event("resize"))}componentDidUpdate(e){e.ui.tiles!==this.props.ui.tiles&&this.map&&this.initializeTileLayer()}UNSAFE_componentWillReceiveProps(e){B(e.domain.locations,this.props.domain.locations)||this.loadClusterData(e.domain.locations);const{bounds:t}=e.app.map;if(B(t,this.props.app.map.bounds)||null===t){if(!B(e.app.selected,this.props.app.selected)){const t=e.app.selected.length>0?e.app.selected[0]:null;null!==t&&t.latitude&&t.longitude&&this.map.setView([t.latitude,t.longitude],this.map.getZoom(),{animate:!0,pan:{duration:.7}})}}else this.map.fitBounds(t)}getTileUrl(e){return"openstreetmap"!==e&&Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).MAPBOX_TOKEN&&"your_token"!==Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).MAPBOX_TOKEN?-1!==Sr.indexOf(this.props.ui.tiles)?`https://api.mapbox.com/styles/v1/mapbox/${this.props.ui.tiles}/tiles/{z}/{x}/{y}?access_token=${Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).MAPBOX_TOKEN}`:`https://api.mapbox.com/styles/v1/mapbox/${Sr[0]}/tiles/{z}/{x}/{y}?access_token=${Object({title:"example",display_title:"example",SERVER_ROOT:"http://localhost:4040",EVENTS_EXT:"/api/timemap_data/export_events/deeprows",ASSOCIATIONS_EXT:"/api/timemap_data/export_associations/deeprows",SOURCES_EXT:"/api/timemap_data/export_sources/deepids",SITES_EXT:"",SHAPES_EXT:"",DATE_FMT:"MM/DD/YYYY",TIME_FMT:"hh:mm",store:{app:{map:{anchor:[8.130912119045295,-66.63830778451526]}},features:{COLOR_BY_ASSOCIATION:!0,USE_ASSOCIATIONS:!0,USE_FULLSCREEN:!0,USE_SOURCES:!0,USE_COVER:!1,GRAPH_NONLOCATED:!1,HIGHLIGHT_GROUPS:!1}},NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).MAPBOX_TOKEN}`:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png"}initializeTileLayer(){if(!this.map)return;const e=this.getTileUrl(this.props.ui.tiles);this.tileLayer?this.tileLayer.setUrl(e):(this.tileLayer=L.tileLayer(e),this.tileLayer.addTo(this.map))}initializeMap(){const{map:e,cluster:t}=this.props.app,s=L.map(this.props.ui.dom.map).setView(e.anchor,e.startZoom).setMinZoom(e.minZoom).setMaxZoom(e.maxZoom).setMaxBounds(e.maxBounds);this.superclusterIndex=new ar.a(t),s.keyboard.disable(),s.zoomControl.remove(),s.on("moveend",(()=>{this.updateClusters(),this.alignLayers()})),s.on("zoomend viewreset",(()=>{this.map.dragging.enable(),this.map.doubleClickZoom.enable(),this.map.scrollWheelZoom.enable(),Object(rr.flushSync)((()=>{this.alignLayers(),this.updateClusters()}))})),s.on("zoomstart",(()=>{null!==this.svgRef.current&&this.svgRef.current.classList.add("hide")})),s.on("zoomend",(()=>{null!==this.svgRef.current&&this.svgRef.current.classList.remove("hide")})),window.addEventListener("resize",(()=>{this.alignLayers()})),this.map=s}getMapDetails(){const e=this.map.getBounds();return[[e.getWest(),e.getSouth(),e.getEast(),e.getNorth()],this.map.getZoom()]}updateClusters(){const[e,t]=this.getMapDetails();this.superclusterIndex&&this.state.indexLoaded&&this.setState({clusters:this.superclusterIndex.getClusters(e,t)})}loadClusterData(e){if(e&&e.length>0&&this.superclusterIndex){const t=e.reduce(((e,t)=>{const{longitude:s,latitude:i}=t;if(Q(i)&&J(s)){const r={type:"Feature",properties:{cluster:!1,id:t.label},geometry:{type:"Point",coordinates:[s,i]}};e.push(r)}return e}),[]);this.superclusterIndex.load(t),this.setState({indexLoaded:!0},(()=>{this.updateClusters()}))}else this.setState({clusters:[]})}getClusterChildren(e){if(this.superclusterIndex)try{return ee(this.superclusterIndex.getLeaves(e,1/0,0),this.props.domain.locations)}catch(t){return[]}return[]}getSelectedClusters(){const{selected:e}=this.props.app,t=e.map((e=>e.id));return this.state.clusters&&this.state.clusters.length>0?this.state.clusters.reduce(((e,s)=>{if(s.properties.cluster){const i=this.getClusterChildren(s.properties.cluster_id);i&&i.length>0&&i.forEach((i=>{const r=e.findIndex((e=>e.id===s.id))>=0;t.includes(i.id)&&!r&&e.push(s)}))}return e}),[]):[]}alignLayers(){const e=document.querySelector(".leaflet-map-pane");if(null===e)return{transformX:0,transformY:0};const t=window.getComputedStyle(e).getPropertyValue("transform");this.setState({mapTransformX:+t.split(",")[4],mapTransformY:+t.split(",")[5].split(")")[0]})}projectPoint(e){const t=new L.LatLng(e[0],e[1]);return{x:this.map.latLngToLayerPoint(t).x+this.state.mapTransformX,y:this.map.latLngToLayerPoint(t).y+this.state.mapTransformY}}onClusterSelect(e){let{id:t,latitude:s,longitude:i}=e;const r=Math.max(this.superclusterIndex.getClusterExpansionZoom(parseInt(t)),this.superclusterIndex.options.minZoom),n=Math.max(r+2,this.props.app.cluster.maxZoom);this.map.flyTo(new L.LatLng(s,i),n)}getClientDims(){const e=document.querySelector(`#${this.props.ui.dom.map}`).getBoundingClientRect();return{width:e.width,height:e.height}}renderTiles(){const e=this.map.getPanes().overlayPane,{width:t,height:s}=this.getClientDims();return this.map?Object(zs.jsx)(nr.a,{node:e,children:Object(zs.jsx)("svg",{ref:this.svgRef,width:t,height:s,style:{transform:`translate3d(${-this.state.mapTransformX}px, ${-this.state.mapTransformY}px, 0)`},className:"leaflet-svg"})}):null}renderSites(){return Object(zs.jsx)(or,{sites:this.props.domain.sites,projectPoint:this.projectPoint,isEnabled:this.props.app.views.sites})}renderRegions(){return Object(zs.jsx)(lr,{svg:this.svgRef.current,regions:this.props.domain.regions,projectPoint:this.projectPoint,styles:this.props.ui.regions})}renderNarratives(){const e=this.props.domain.narratives.length>0;return Object(zs.jsx)(jr,{svg:this.svgRef.current,narratives:e?this.props.domain.narratives:[this.props.app.narrative],projectPoint:this.projectPoint,narrative:this.props.app.narrative,styles:this.props.ui.narratives,onSelectNarrative:this.props.methods.onSelectNarrative,features:this.props.features})}styleLocation(e){return[null,null]}styleCluster(e){return[null,null]}renderEvents(){const e=ee(this.state.clusters.filter((e=>!e.properties.cluster)),this.props.domain.locations);return Object(zs.jsx)(cr,{svg:this.svgRef.current,events:this.props.domain.events,locations:e,styleLocation:this.styleLocation,categories:this.props.domain.categories,projectPoint:this.projectPoint,selected:this.props.app.selected,narrative:this.props.app.narrative,onSelect:this.props.methods.onSelect,getCategoryColor:this.props.methods.getCategoryColor,eventRadius:this.props.ui.eventRadius,coloringSet:this.props.app.coloringSet,filterColors:this.props.ui.filterColors,features:this.props.features})}renderClusters(){const e=this.state.clusters.filter((e=>e.properties.cluster));return Object(zs.jsx)(pr,{svg:this.svgRef.current,styleCluster:this.styleCluster,projectPoint:this.projectPoint,clusters:e,isRadial:this.props.ui.radial,onSelect:this.onClusterSelect,coloringSet:this.props.app.coloringSet,getClusterChildren:this.getClusterChildren,filterColors:this.props.ui.filterColors})}renderSelected(){const e=this.getSelectedClusters(),t=[];this.props.app.selected.forEach((e=>{const{latitude:s,longitude:i,id:r}=e;t.push({id:r,latitude:s,longitude:i,radius:this.props.ui.eventRadius})}));const s=Z(this.state.clusters);return e.forEach((e=>{if(e.properties.cluster){const{coordinates:i}=e.geometry;t.push({id:e.id,latitude:String(i[1]),longitude:String(i[0]),radius:q(e.properties.point_count,s)})}})),Object(zs.jsx)(mr,{svg:this.svgRef.current,selected:t,projectPoint:this.projectPoint,styles:this.props.ui.mapSelectedEvents})}renderMarkers(){return Object(zs.jsx)(nr.a,{node:this.svgRef.current,children:Object(zs.jsx)(br,{})})}render(){const{isShowingSites:e,isFetchingDomain:t}=this.props.app.flags,s=this.props.app.narrative?"map-wrapper narrative-mode":"map-wrapper",i=this.map?Object(zs.jsxs)(zs.Fragment,{children:[this.renderTiles(),this.renderMarkers(),e?this.renderSites():null,this.renderRegions(),this.renderNarratives(),this.renderEvents(),this.renderClusters(),this.renderSelected()]}):null;return Object(zs.jsxs)("div",{className:s,onKeyDown:this.props.onKeyDown,tabIndex:"0",children:[Object(zs.jsx)("div",{id:this.props.ui.dom.map}),Object(zs.jsx)(Ri,{isLoading:this.props.app.loading||t,ui:t,language:this.props.app.language}),this.props.features.USE_SATELLITE_OVERLAY_TOGGLE&&Object(zs.jsx)(vr,{isUsingSatellite:"satellite"===this.props.ui.tiles,toggleView:this.props.actions.toggleSatelliteView}),i]})}}var Er=Object(l.b)((function(e){return{domain:{locations:Bt(e),narratives:Xt(e),categories:Nt(e),sites:Gt(e),regions:Ft(e)},app:{views:e.app.associations.views,selected:Zt(e),highlighted:e.app.highlighted,map:e.app.map,cluster:e.app.cluster,language:e.app.language,loading:e.app.loading,narrative:e.app.associations.narrative,coloringSet:e.app.associations.coloringSet,flags:{isShowingSites:e.app.flags.isShowingSites,isFetchingDomain:e.app.flags.isFetchingDomain}},ui:{tiles:Mt(e),dom:e.ui.dom,narratives:e.ui.style.narratives,mapSelectedEvents:e.ui.style.selectedEvents,regions:e.ui.style.regions,eventRadius:e.ui.eventRadius,radial:e.ui.style.clusters.radial,filterColors:e.ui.coloring.colors},features:Ht(e)}}),(function(e){return{actions:Object(c.bindActionCreators)(i,e)}}))(xr);var _r=e=>(e.kind,Object(zs.jsx)(Er,{...e}));var yr=e=>{let{query:t,eventObj:s,onSearchRowClick:i}=e;const{description:r,location:n,date:a}=s;function o(e,t){const s=e.split(new RegExp(`(${t})`,"gi"));return Object(zs.jsx)("span",{children:s.map((e=>e.toLowerCase()===t.toLowerCase()?Object(zs.jsx)("span",{style:{backgroundColor:"yellow",color:"black"},children:e}):e))})}return Object(zs.jsxs)("div",{className:"search-row",onClick:()=>i([s]),children:[Object(zs.jsxs)("div",{className:"location-date-container",children:[Object(zs.jsxs)("div",{className:"date-container",children:[Object(zs.jsx)("i",{className:"material-icons",children:"event"}),Object(zs.jsx)("p",{children:o(a,t)})]}),Object(zs.jsxs)("div",{className:"location-container",children:[Object(zs.jsx)("i",{className:"material-icons",children:"location_on"}),Object(zs.jsx)("p",{children:o(n,t)})]})]}),Object(zs.jsx)("p",{children:function(e,t){const s=new RegExp(`(([^ ]* ){0,6}[a-zA-Z]*${t.toLowerCase()}[a-zA-Z]*( [^ ]*){0,5})`,"gm"),i=e.toLowerCase().match(s);for(let n=0;n<(i?i.length:0);n++)i[n]="..."+i[n];const r=[e.match("(([^ ]* ){0,10})","m")[0]];return i||r}(r,t).map((e=>Object(zs.jsxs)("span",{children:[o(e,t),"...",Object(zs.jsx)("br",{})]})))})]})};class Tr extends n.a.Component{constructor(e){super(e),this.state={isFolded:!0},this.onButtonClick=this.onButtonClick.bind(this),this.updateSearchQuery=this.updateSearchQuery.bind(this)}onButtonClick(){this.setState((e=>({isFolded:!e.isFolded})))}updateSearchQuery(e){const t=e.target.value;this.props.actions.updateSearchQuery(t)}render(){let e;const t=["description","location","category","date"];return e=this.props.queryString?this.props.events.filter((e=>t.some((t=>e[t].toLowerCase().includes(this.props.queryString.toLowerCase()))))):[],Object(zs.jsxs)("div",{className:"search-outer-container"+(this.props.narrative?" narrative-mode ":""),children:[Object(zs.jsx)("div",{id:"search-bar-icon-container",onClick:this.onButtonClick,children:Object(zs.jsx)("i",{className:"material-icons",children:"search"})}),Object(zs.jsxs)("div",{className:"search-bar-overlay"+(this.state.isFolded?" folded":""),children:[Object(zs.jsxs)("div",{className:"search-input-container",children:[Object(zs.jsx)("input",{className:"search-bar-input",onChange:this.updateSearchQuery,type:"text"}),Object(zs.jsx)("i",{id:"close-search-overlay",className:"material-icons",onClick:this.onButtonClick,children:"close"})]}),Object(zs.jsx)("div",{className:"search-results",children:e.map((e=>Object(zs.jsx)(yr,{onSearchRowClick:this.props.onSearchRowClick,eventObj:e,query:this.props.queryString})))})]})]})}}var Cr=Object(l.b)((e=>e),(function(e){return{actions:Object(c.bindActionCreators)(i,e)}}))(Tr);var Nr=e=>{let{title:t,value:s,hoverValue:i=null}=e;const[n,a]=Object(r.useState)(!1);return Object(zs.jsxs)("div",{className:"card-cell",children:[t?Object(zs.jsx)("h4",{children:t}):null,Object(zs.jsx)("div",{style:{width:"fit-content"},children:Object(zs.jsx)("div",{onMouseOver:()=>i&&a(!0),onMouseOut:()=>i&&a(!1),children:n?Object(zs.jsx)("span",{style:{pointerEvents:"none",opacity:.8},children:Object(zs.jsx)("em",{children:i})}):Object(zs.jsx)("div",{style:{pointerEvents:"none",display:"inline-block",height:"1.1rem",borderBottom:i&&"1px rgb(235, 68, 62) dashed"},children:s})})})]})};var Rr=e=>{let{title:t="Timestamp",timelabel:s,language:i,precision:r}=e;const n=ps[i].cardstack.unknown_time;return"undefined"!==typeof(a=s)&&null!==a?Object(zs.jsxs)("div",{className:"card-cell",children:[Object(zs.jsx)("h4",{children:t}),s,r&&""!==r?` - ${r}`:null]}):Object(zs.jsxs)("div",{className:"card-cell",children:[Object(zs.jsx)("h4",{children:t}),n]});var a};const Ar=e=>{let{primary:t,backgroundColor:s,borderRadius:i,size:r,label:n,normalCursor:a,...o}=e;const l=t?"button--primary":"button--secondary";return Object(zs.jsx)("button",{type:"button",className:["button",`button--${r}`,l,a?"no-hover":""].join(" "),style:{backgroundColor:s,borderRadius:i},...o,children:n})};Ar.defaultProps={backgroundColor:"red",borderRadius:"0%",primary:!1,size:"medium",onClick:void 0};var wr=e=>{let{text:t,color:s="#000",onClick:i=()=>{},normalCursor:r}=e;return Object(zs.jsx)(Ar,{size:"small",backgroundColor:s,borderRadius:"12px",primary:!1,label:t,onClick:i,normalCursor:r})};var kr=e=>{let{isOpen:t,toggle:s}=e,i=t?"arrow-down":"arrow-down folded";return Object(zs.jsx)("div",{className:"card-toggle",onClick:s,children:Object(zs.jsx)("p",{children:Object(zs.jsx)("i",{className:i})})})};var Ir=e=>{let{title:t,value:s}=e;return Object(zs.jsxs)("div",{className:"card-cell",children:[t?Object(zs.jsx)("h4",{children:t}):null,Object(zs.jsx)("div",{dangerouslySetInnerHTML:{__html:Object(Ws.marked)(`${s}`)}})]})},Lr=s(196);const Dr={width:"100%",frameBorder:"0",scrolling:"no",border:"none",overflow:"hidden"},Pr={};class Ur extends r.Component{constructor(e){super(e),this.state={src:this.props.src,id:"",height:"80px"},this.messageHandler=this.messageHandler.bind(this),this.urlObj=document.createElement("a")}componentDidMount(){window.addEventListener("message",this.messageHandler),this.iFrame.addEventListener("load",(()=>{this.checkFrame(this.state.id)}))}componentWillUnmount(){window.removeEventListener("message",this.messageHandler)}messageHandler(e){let{data:t,source:s}=e;if(!t||"string"!==typeof t||s!==this.iFrame.contentWindow)return;const i=JSON.parse(t);"resize"===i.event&&i.height&&this.setState({height:i.height+"px"})}checkFrame(e){this.iFrame.contentWindow.postMessage(JSON.stringify({event:"visible",frame:e}),"*")}UNSAFE_componentWillReceiveProps(e){let{src:t}=e;if(this.state.src!==t){this.urlObj.href=t;const e=`telegram-post${this.urlObj.pathname.replace(/[^a-z0-9_]/gi,"-")}`;this.setState({src:t,id:e},(()=>this.checkFrame(e)))}}render(){const{src:e,height:t}=this.state,{container:s}=this.props;return Object(zs.jsx)("div",{"data-sharing-id":s,style:Pr,children:Object(zs.jsx)("iframe",{title:e,ref:e=>this.iFrame=e,src:e+"?embed=1",height:t,id:"telegram-post"+this.urlObj.pathname.replace(/[^a-z0-9_]/gi,"-"),style:Dr})})}}var Hr=Ur;var Mr=e=>{let{src:t,title:s}=e;const i=Object(r.useRef)(),n=Object(r.useCallback)((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.play()}),[]),a=Object(r.useCallback)((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.pause()}),[]),o=z(t),l=s&&s.length>50?`${s.slice(0,51)}...`:s;switch(o){case"Video":return Object(zs.jsxs)("div",{className:"card-cell media",children:[s&&Object(zs.jsx)("h4",{title:s,children:l}),Object(zs.jsx)("video",{onMouseEnter:n,onMouseLeave:a,ref:i,disablePictureInPicture:!0,children:Object(zs.jsx)("source",{src:t})})]});case"Image":return Object(zs.jsxs)("div",{className:"card-cell media",children:[s&&Object(zs.jsx)("h4",{title:s,children:l}),Object(zs.jsx)("div",{className:"img-wrapper",children:Object(zs.jsx)("img",{src:t,alt:"an inline photograph for the event card component"})})]});case"Telegram":return Object(zs.jsx)("div",{className:"card-cell media embedded",children:Object(zs.jsx)(Hr,{src:t})});case"Tweet":const e=/https?:\/\/twitter.com\/[0-9a-zA-Z_]{1,20}\/status\/([0-9]*)/.exec(t)[1];return Object(zs.jsx)("div",{className:"card-cell media embedded",children:Object(zs.jsx)(Lr.a,{tweetId:e})});default:return"HIDDEN"===t?Object(zs.jsx)("div",{className:"card-cell media source-hidden",children:Object(zs.jsxs)("h4",{children:["Source hidden",Object(zs.jsx)("br",{}),"Privacy concerns"]})}):null}};const Gr={basic:e=>{let{event:t}=e;return[[{kind:"date",title:"Incident Date",value:t.datetime||t.date||""},{kind:"text",title:"Location",value:t.location||"\u2014"}],[{kind:"line-break",times:.4}],[{kind:"text",title:"Summary",value:t.description||"",scaleFont:1.1}]]},sourced:e=>{let{event:t}=e;return[[{kind:"date",title:"Incident Date",value:t.datetime||t.date||""},{kind:"text",title:"Location",value:t.location||"\u2014"}],[{kind:"text",title:"Summary",value:t.description||"",scaleFont:1.1}],...t.sources.flatMap((e=>[e.paths.map((e=>({kind:"media",title:"Media",value:[{src:e,title:null}]})))]))]}},Fr=e=>{let{content:t=[],isLoading:s=!0,onSelect:i=()=>{},sources:n=[],isSelected:a=!1,language:o="en-US"}=e;const[l,c]=Object(r.useState)(!1),d=e=>Object(zs.jsx)(Rr,{language:o,timelabel:ie(e.value),...e}),u=e=>{let{media:t,idx:s}=e;return Object(zs.jsx)(Mr,{src:t.src,title:t.title},s)};function p(e){switch(e.kind){case"media":return Object(zs.jsx)("div",{className:"card-cell",children:e.value.map(((e,t)=>u({media:e,idx:t})))});case"line":return Object(zs.jsx)("div",{style:{height:"1rem",width:"100%"},children:Object(zs.jsx)("hr",{})});case"line-break":return Object(zs.jsx)("div",{style:{height:`${e.times||1}rem`,width:"100%"}});case"item":default:return null;case"markdown":return Object(zs.jsx)(Ir,{...e});case"tag":return Object(zs.jsx)("div",{className:"card-cell m0",style:{textTransform:"uppercase",fontSize:".8em",lineHeight:".8em"},children:Object(zs.jsx)("div",{style:{display:"flex",justifyContent:`flex-${e.align||"start"}`},children:e.value})});case"button":return Object(zs.jsxs)("div",{className:"card-cell",children:[e.title&&Object(zs.jsx)("h4",{children:e.title}),e.value.map(((e,t)=>Object(zs.jsx)(wr,{...e},`card-button-${t}`)))]});case"text":return!re(e.value)&&Object(zs.jsx)(Nr,{...e});case"date":return d(e);case"links":return Object(zs.jsxs)("div",{className:"card-cell",children:[e.title&&Object(zs.jsx)("h4",{children:e.title}),Object(zs.jsx)("div",{className:"card-row m0",children:e.value.map(((e,t)=>{let{text:s,href:i}=e;return Object(zs.jsx)("a",{href:i,children:s},`card-links-url-${t}`)}))})]});case"list":return!!e.value.length&&!!e.value.filter((e=>!re(e))).length?Object(zs.jsxs)("div",{children:[e.title&&Object(zs.jsx)("h4",{children:e.title}),Object(zs.jsx)("div",{className:"card-row m0",children:e.value.map(((e,t)=>Object(zs.jsx)(Nr,{value:e,...e},`card-list-text-${t}`)))})]}):null}}return n=[],Object(zs.jsxs)("li",{className:"event-card "+(a?"selected":""),onClick:i,children:[t.map((e=>function(e){return Object(zs.jsx)("div",{className:"card-row",children:e.map((e=>Object(zs.jsx)("span",{children:p(e)},j()(e))))},j()(e))}(e))),l&&Object(zs.jsx)("div",{className:"card-bottomhalf",children:n.map((()=>Object(zs.jsx)("div",{className:"card-row"})))}),n.length>0?0===n.length&&Object(zs.jsx)(kr,{toggle:()=>c(!l),isOpen:l}):null]},j()(t))};class $r extends n.a.Component{constructor(){super(),this.refs={},this.refCardStack=n.a.createRef(),this.refCardStackContent=n.a.createRef()}componentDidUpdate(){!!this.props.narrative&&this.scrollToCard()}scrollToCard(){const e=this.refCardStack.current,t=this.refs[this.props.narrative.current].current.offsetTop,s=e.scrollTop,i=t-s;let r=0;Math.easeInOutQuad=function(e,t,s,i){return(e/=i/2)<1?s/2*e*e+t:-s/2*((e-=1)*(e-2)-1)+t};const n=function(){r+=20;const t=Math.easeInOutQuad(r,s,i,500);e.scrollTop=t,r<500&&setTimeout(n,20)};n()}renderCards(e,t){t||(t=e.map((e=>!0))),this.refs=[];const s=Gr[this.props.cardUI.layout.template];return e.map(((e,i)=>{const r=n.a.createRef();this.refs[i]=r;const a=s({event:e,colors:this.props.colors,coloringSet:this.props.coloringSet,getFilterIdxFromColorSet:se});return Object(zs.jsx)(Fr,{content:a,language:this.props.language,isLoading:this.props.isLoading,isSelected:t[i]},j()(a))}))}renderSelectedCards(){const{selected:e}=this.props;return e.length>0?this.renderCards(e):null}renderNarrativeCards(){const{narrative:e}=this.props,t=e.steps,s=t.map(((t,s)=>s===e.current));return this.renderCards(t,s)}renderCardStackHeader(){const e=ps[this.props.language].cardstack.header;return Object(zs.jsxs)("div",{id:"card-stack-header",className:"card-stack-header",onClick:()=>this.props.onToggleCardstack(),children:[Object(zs.jsx)("button",{className:"side-menu-burg is-active",children:Object(zs.jsx)("span",{})}),Object(zs.jsx)("p",{className:"header-copy top",children:`${this.props.selected.length} ${e}`})]})}renderCardStackContent(){return Object(zs.jsx)("div",{id:"card-stack-content",className:"card-stack-content",children:Object(zs.jsx)("ul",{children:this.renderSelectedCards()})})}renderNarrativeContent(){return Object(zs.jsx)("div",{id:"card-stack-content",className:"card-stack-content",ref:this.refCardStackContent,children:Object(zs.jsx)("ul",{children:this.renderNarrativeCards()})})}render(){const{isCardstack:e,selected:t,narrative:s}=this.props;return t.length>0?s?Object(zs.jsx)("div",{id:"card-stack",ref:this.refCardStack,className:"card-stack narrative-mode\n            "+(e?"":" folded"),children:this.renderNarrativeContent()}):Object(zs.jsxs)("div",{id:"card-stack",className:"card-stack "+(e?"":" folded"),children:[this.renderCardStackHeader(),this.renderCardStackContent()]}):Object(zs.jsx)("div",{})}}var Yr=Object(l.b)((function(e){return{narrative:zt(e),selected:Zt(e),sourceError:e.app.errors.source,language:e.app.language,isCardstack:e.app.flags.isCardstack,isLoading:e.app.flags.isFetchingSources,cardUI:e.ui.card,colors:e.ui.coloring.colors,coloringSet:e.app.associations.coloringSet,features:e.features}}))($r);var Xr=Object(l.b)((function(e){return{narrative:zt(e)}}))((function(e){let{narrative:t}=e;const{steps:s,current:i}=t;return s[i]?Object(zs.jsxs)("div",{className:"narrative-info",children:[Object(zs.jsxs)("div",{className:"narrative-info-header",children:[Object(zs.jsx)("div",{className:"count-container",children:Object(zs.jsxs)("div",{className:"count",children:[i+1,"/",s.length]})}),Object(zs.jsx)("div",{children:Object(zs.jsx)("h3",{children:t.label})})]}),Object(zs.jsx)("div",{className:"narrative-info-desc",children:Object(zs.jsx)("p",{children:t.description})})]}):null}));var Vr=e=>{let{isDisabled:t,direction:s,onClickHandler:i}=e;return Object(zs.jsx)("div",{className:`narrative-adjust ${s}`,onClick:t?null:i,children:Object(zs.jsx)("i",{className:"material-icons "+(t?"disabled":""),children:`chevron_${s}`})})};var zr=e=>{let{onClickHandler:t,closeMsg:s}=e;return Object(zs.jsxs)("div",{className:"narrative-close",onClick:t,children:[Object(zs.jsx)("button",{className:"side-menu-burg is-active",children:Object(zs.jsx)("span",{})}),Object(zs.jsx)("div",{className:"close-text",children:s})]})};var Br=e=>{let{narrative:t,methods:s}=e;if(!t)return null;const{current:i,steps:r}=t,n=0!==i,a=i<r.length-1;return Object(zs.jsxs)(zs.Fragment,{children:[Object(zs.jsx)(Xr,{narrative:t}),Object(zs.jsx)(Vr,{isDisabled:!n,direction:"left",onClickHandler:s.onPrev}),Object(zs.jsx)(Vr,{isDisabled:!a,direction:"right",onClickHandler:s.onNext}),Object(zs.jsx)(zr,{onClickHandler:()=>s.onSelectNarrative(null),closeMsg:"-- exit from narrative --"})]})};class Wr extends n.a.Component{constructor(e){super(e),this.handleViewSource=this.handleViewSource.bind(this),this.handleHighlight=this.handleHighlight.bind(this),this.setNarrative=this.setNarrative.bind(this),this.setNarrativeFromFilters=this.setNarrativeFromFilters.bind(this),this.handleSelect=this.handleSelect.bind(this),this.getCategoryColor=this.getCategoryColor.bind(this),this.findEventIdx=this.findEventIdx.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.selectNarrativeStep=this.selectNarrativeStep.bind(this)}componentDidMount(){this.props.app.isMobile||this.props.actions.fetchDomain().then((e=>{const{actions:t,features:s}=this.props;t.updateDomain({domain:e,features:s}),t.rehydrateState()})),window.dispatchEvent(new Event("resize"))}handleHighlight(e){this.props.actions.updateHighlighted(e||null)}handleViewSource(e){this.props.actions.updateSource(e)}findEventIdx(e){const{events:t}=this.props.domain;return function(e,t,s){let i=0,r=e.length-1;for(;i<=r;){const n=r+i>>1,a=s(t,e[n]);if(a>0)i=n+1;else{if(!(a<0))return n;r=n-1}}return-i-1}(t,e,((e,t)=>e.datetime-t.datetime))}handleSelect(e,t){if(e.length<=0)return void this.props.actions.updateSelected([]);const s=[];if(0===t){s.push(e);const{events:t}=this.props.domain,i=this.findEventIdx(e);t[i].id!==e.id&&s.push(t[i]);let r=i-1;for(;r>=0&&t[i].datetime.getTime()===t[r].datetime.getTime();)t[r].id!==e.id&&s.push(t[r]),r-=1;for(r=i+1;r<t.length&&t[i].datetime.getTime()===t[r].datetime.getTime();)t[r].id!==e.id&&s.push(t[r]),r+=1}else{const t={...e};delete t.sources,Object.values(t).forEach((e=>s.push(e)))}this.props.actions.updateSelected(s)}getCategoryColor(e){if(!this.props.features.USE_CATEGORIES)return us.fallbackEventColor;const t=this.props.ui.style.categories[e];return t||this.props.ui.style.categories.default}setNarrative(e){e&&e.steps.length>=1&&this.handleSelect([e.steps[0]]),this.props.actions.updateNarrative(e)}setNarrativeFromFilters(e){const{app:t,domain:s}=this.props;let i=t.associations.filters;if(0===i.length)return void alert("No filters selected, cant narrativise");i=i.map((e=>({name:e})));const r=s.events.filter((e=>{let t=!1;for(let s=0;s<i.length;s++)if(e.associations.includes(i[s].name)){t=!0;break}return!!t}));if(0===r.length)return void alert("No associated events, cant narrativise");const n=i.map((e=>e.name)).join("-"),a=i.map((e=>e.description)).join("\n\n");this.setNarrative({id:n,label:n,description:a,withLines:e,steps:r.map(Y(s.sources))})}selectNarrativeStep(e){if("number"!==typeof e){const t=e[0]||e;if(this.props.app.associations.narrative){const{steps:s}=this.props.app.associations.narrative,i=t.id,r=s.find((e=>e.id===i)),n=s.indexOf(r);n>-1&&(e=n)}}const{narrative:t}=this.props.app.associations;if(null!==t&&e<t.steps.length&&e>=0){const s=t.steps[e];this.handleSelect([s]),this.props.actions.updateNarrativeStepIdx(e)}}onKeyDown(e){const{narrative:t,selected:s}=this.props.app,{events:i}=this.props.domain,r=e=>{null===t?this.handleSelect(i[e-1],0):this.selectNarrativeStep(this.props.narrativeIdx-1)},n=e=>{null===t?this.handleSelect(i[e+1],0):this.selectNarrativeStep(this.props.narrativeIdx+1)};if(s.length>0){const t=s[s.length-1],i=this.findEventIdx(t);switch(e.keyCode){case 37:case 38:if(i<=0)return;r(i);break;case 39:case 40:if(i<0||i>=this.props.domain.length-1)return;n(i)}}}renderIntroPopup(e,t){const{app:s,actions:i}=this.props,r=e?Object(zs.jsx)("div",{style:{position:"relative",bottom:0},children:Object(zs.jsxs)("h3",{style:{color:"var(--error-red)"},children:["This platform is not suitable for mobile.",Object(zs.jsx)("br",{}),Object(zs.jsx)("br",{}),"Please re-visit the site on a device with a larger screen."]})}):null;return Object(zs.jsx)(ui,{title:"Introduction to the platform",theme:"dark",isOpen:s.flags.isIntropopup,onClose:i.toggleIntroPopup,content:s.intro,styles:t,isMobile:e,children:r})}render(){const{actions:e,app:t,domain:s,features:i}=this.props,r=Xs.isMobileOnly||window.innerWidth<600,n={height:r?"100vh":"fit-content",display:r?"block":"table",width:r?"100vw":window.innerWidth>768?"60vw":"calc(100vw - var(--toolbar-width))",maxWidth:r?"100vw":600,maxHeight:r?"100vh":window.innerHeight>768?`calc(100vh - ${t.timeline.dimensions.height}px - 80px)`:"100vh",left:r?2:"var(--toolbar-width)",top:0,overflowY:"scroll"};if(r){const e="This platform is not suitable for mobile. Please re-visit the site on a device with a larger screen.";return Object(zs.jsxs)("div",{children:[i.USE_COVER&&!t.intro&&Object(zs.jsx)(Ni,{showing:t.flags.isCover,children:Object(zs.jsx)(Ci,{showAppHandler:()=>{alert(e)}})}),t.intro&&Object(zs.jsx)(zs.Fragment,{children:this.renderIntroPopup(!0,n)}),!t.intro&&!i.USE_COVER&&Object(zs.jsx)("div",{className:"fixedTooSmallMessage",children:e})]})}return Object(zs.jsxs)("div",{children:[Object(zs.jsx)(ci,{isNarrative:!!t.associations.narrative,methods:{onTitle:e.toggleCover,onSelectFilter:t=>e.toggleAssociations("filters",t),onCategoryFilter:t=>e.toggleAssociations("categories",t),onShapeFilter:e.toggleShapes,onSelectNarrative:this.setNarrative}}),Object(zs.jsx)(_r,{kind:"map"in t?"map":"space3d",onKeyDown:this.onKeyDown,methods:{onSelectNarrative:this.setNarrative,getCategoryColor:this.getCategoryColor,onSelect:t.associations.narrative?this.selectNarrativeStep:e=>this.handleSelect(e,1)}}),Object(zs.jsx)(ir,{onKeyDown:this.onKeyDown,methods:{onSelect:t.associations.narrative?this.selectNarrativeStep:e=>this.handleSelect(e,0),onUpdateTimerange:e.updateTimeRange,getCategoryColor:this.getCategoryColor}}),Object(zs.jsx)(Yr,{timelineDims:t.timeline.dimensions,onViewSource:this.handleViewSource,onSelect:t.associations.narrative?this.selectNarrativeStep:()=>null,onHighlight:this.handleHighlight,onToggleCardstack:()=>e.updateSelected([]),getCategoryColor:this.getCategoryColor}),Object(zs.jsx)(Br,{narrative:t.associations.narrative?{...t.associations.narrative,current:this.props.narrativeIdx}:null,methods:{onNext:()=>this.selectNarrativeStep(this.props.narrativeIdx+1),onPrev:()=>this.selectNarrativeStep(this.props.narrativeIdx-1),onSelectNarrative:this.setNarrative}}),Object(zs.jsx)(pi,{language:t.language,styles:n,isOpen:t.flags.isInfopopup,onClose:e.toggleInfoPopup}),this.renderIntroPopup(!1,n),t.debug?Object(zs.jsx)(hi,{isNotification:t.flags.isNotification,notifications:s.notifications,onToggle:e.markNotificationsRead}):null,i.USE_SEARCH&&Object(zs.jsx)(Cr,{narrative:t.narrative,queryString:t.searchQuery,events:s.events,onSearchRowClick:this.handleSelect}),t.source?Object(zs.jsx)(_i,{source:t.source,onCancel:()=>{e.updateSource(null)}}):null,Object(zs.jsx)(Ri,{isLoading:t.loading||t.flags.isFetchingDomain,ui:t.flags.isFetchingDomain,language:t.language}),i.USE_COVER&&Object(zs.jsx)(Ni,{showing:t.flags.isCover,children:Object(zs.jsx)(Ci,{showing:t.flags.isCover,showAppHandler:e.toggleCover})})]})}}var Kr=Object(l.b)((e=>({...e,narrativeIdx:Vt(e),narratives:Xt(e),selected:Zt(e)})),(function(e){return{actions:Object(c.bindActionCreators)(i,e)}}))(Wr);class qr extends n.a.Component{render(){return Object(zs.jsx)(Kr,{})}}var Zr=qr;o.a.createRoot(document.getElementById("explore-app")).render(Object(zs.jsx)(l.a,{store:Ys,children:Object(zs.jsx)(Zr,{})}));const Qr=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,Jr=(/constructor/i.test(window.HTMLElement)||(!window.safari||"undefined"!==typeof safari&&safari.pushNotification).toString(),!!document.documentMode),en=!Jr&&!!window.StyleMedia;(!!window.chrome&&!!window.chrome.webstore||Qr)&&window.CSS;(en||Jr)&&alert("Please view this website in Opera for best viewing. It is untested in your browser.")},8:function(e){e.exports=JSON.parse('{"es-MX":{"tiles":{"default":"Mapa","satellite":"Sat"},"loading":"Cargando...","legend":{"view2d":{"paragraphs":["Seleccionando una serie de filtros ver\xe1 aparecer eventos en el mapa y en la l\xednea del tiempo.","Cada evento estar\xe1 coloreado seg\xfan la persona que dio el testimonio del evento."],"colors":[{"class":"category_group00","label":"Categor\xeda Grupo 00"},{"class":"category_group01","label":"Categor\xeda Grupo 01"},{"class":"category_group02","label":"Categor\xeda Grupo 02"},{"class":"category_group03","label":"Categor\xeda Grupo 03"},{"class":"other","label":"Otras categor\xedas"}]},"default":{"header":"Ayudas para explorar la plataforma","intro":["Cada **punto** representa un **evento en los datos** (o cada incidente). Al hacer clic en cada punto se ven los detalles del evento. Pero si le da clic en un **grupo** de puntos, ver\xe1 cuantos eventos hay en ese grupo.","Puede acercarse en el mapa *(zoom)* haciendo *scroll* con el rat\xf3n o haciendo clic en un grupo de puntos.","Puede usar **filtros** para segmentar los datos. En el mapa s\xf3lo vemos los puntos relacionados con cada filtro seleccionado. Cuando no hay filtros seleccionados, vemos todos los puntos de la base de datos en el mapa.","Al seleccionar m\xe1s de un filtro se introducen diferentes colores para diferenciarlos. Esto permite comparar los tipos de incidentes tanto en el mapa, como en la l\xednea de tiempo. Esto sirve con un m\xe1ximo de 6 filtros-colores.","Con el teclado puede usar las flechas de la derecha e izquierda para moverse entre eventos. Tambi\xe9n puede hacer clic y arrastrar la l\xednea de tiempo hacia los lados para modificar el rango de tiempo."],"notation":"Cuando un circulo combina colores significa que hay varios eventos en esa misma ubicaci\xf3n.","arrows":"Usar las flechas izquierda/derecha en el teclado para moverse entre eventos cronol\xf3gicamente."}},"toolbar":{"title":"T\xedtulo","filters":"Filtros","explore_by_filter__title":"Explorar por filtros","explore_by_filter__description":"Al seleccionar filtros, puede ver los eventos que tienen esa categor\xeda. Para ver todos los eventos puede quitar todas las selecciones (o seleccionarlos todos).","panels":{"mentions":{"title":"Personas","overview":"Seleccionar los nombres de personas mostrar\xe1 eventos en los que esta persona o organizaci\xf3n ha sido mencionada, incluyendo el propio testimonio. Entre par\xe9ntesis encontrar\xe1 el n\xfamero de menciones. Ej. (34)."},"categories":{"title":"Testimonios","overview":"Seleccionar el nombre de una persona mostrar\xe1 los eventos descritos por su testimonio. Entre par\xe9ntesis encontrar\xe1 el n\xfamero de eventos descritos. Ej. (34)."},"search":{"title":"Directorio de etiquetas","placeholder":"B\xfasqueda"}},"fullscreen_enter":"Pantalla completa","fullscreen_exit":"Salir de pantalla completa"},"timeline":{"zoomLevels":[{"label":"1 mes","duration":40320},{"label":"2 semanas","duration":20160},{"label":"1 semana","duration":10080}],"labels_title":"Testimonios","labels":["Testimonio Grupo 00","Testimonio Grupo 01","Testimonio Grupo 02","Testimonio Grupo 03","Otras categor\xedas"],"info":"%n eventos ocurridos entre","default_categories_label":"Eventos"},"cardstack":{"date_title":"Fecha incidente","location_title":"Ubicaci\xf3n","summary_title":"Resumen","header":"eventos seleccionados","unknown_location":"Ubicaci\xf3n desconocida","unknown_time":"D\xeda y hora desconocida","timestamp":"D\xeda y hora","estimated":"aproximado","location":"Ubicaci\xf3n","incident_type":"Tipo de acci\xf3n","description":"Hechos","people":"Personas en el evento","sources":"Fuentes","category":"Seg\xfan el testimonio de","communication":"Comunicaci\xf3n","transmitter":"Transmisor","receiver":"Receptor","warning":"(!) HECHOS CUESTIONADOS"}},"en-US":{"tiles":{"default":"Map","satellite":"Sat"},"loading":"Loading...","legend":{"view2d":{"paragraphs":["Selecting a series of filters, you will be able to explore events on the map of Iguala and on the timeline.","Each event is colored according the person that gave category of the event."],"colors":[{"class":"category_group00","label":"Category Group 00"},{"class":"category_group01","label":"Category Group 01"},{"class":"category_group02","label":"Category Group 02"},{"class":"category_group03","label":"Category Group 03"},{"class":"other","label":"Other categories"}]},"default":{"header":"About the Map","intro":["Each post has been categorized by the type of violation according to the Inter-American Commission on Human Rights\' nomenclature. A confidence level has also been assigned based on the source of the information. Users can explore interactive features such as filters and content of the original post. The map will be regularly updated to reflect the latest information.","You can use filter to view incidents related to a specific potential Human Rights violation","The timeline below allows you to explore the events based on the time that they were reported on twitter, not the time of the incident."],"notation":"Combinations of colours within a circle indicate multiple events in a single location.","arrows":"Use the left/right arrows on the keboard to move back and forth between events in time."}},"toolbar":{"title":"TITLE","panels":{"mentions":{"title":"Mentions","overview":"Selecting the names of people/organisation will show events in which these have been mentioned in their own testimony and by others. The number in the parentheses shows how many events contain a mention of a person or organisation, e.g. (34)"},"categories":{"title":"Testimonies","overview":"Selecting the name of a person will show the events only according to a person\u2019s category or category. The number in the parentheses show how many events are contained in each category, e.g. (34)."},"search":{"title":"Directory of filters","placeholder":"Search"}},"narratives":"Narratives","narratives_label":"Narratives","explore_by_narrative__title":"Explore events by narrative","explore_by_narrative__description":"Follow a path through the data, from one key event to the next.","filters":"Filters","filters_label":"Filters","explore_by_filter__title":"Explore by filter","explore_by_filter__description":"\'Filters\' refer to the types of incident. Select multiple filters to introduce colour-coding, up to a maximum of four filters.<br><br>If no filters are selected, all datapoints are displayed.","categories":"Categories","categories_label":"Categories","explore_by_category__title":"Explore events by category","explore_by_category__description":"","shapes":"Shapes","shapes_label":"Shapes","explore_by_shapes__title":"Explore events by shape breakdown","explore_by_shape__description":"Shapes map to a given type of event that appears on the timeline.<br><br>Select the shape marker to toggle this type of event on / off","fullscreen_enter":"Fullscreen","fullscreen_exit":"Exit Fullscreen"},"timeline":{"labels_title":"Testimonies","labels":["Testimony Group 00","Testimony Group 01","Testimony Group 02","Testimony Group 03","Other"],"info":"Seeing %n events that occurred between","default_categories_label":"Events"},"cardstack":{"header":"selected events","timestamp":"Day and time","unknown_location":"Unknown location","estimated":"estimated","unknown_time":"Unknown time","location":"Localization","incident_type":"Type of action","description":"Summary","filters":"Filters","nofilters":"No known filters for this event.","sources":"Sources","unknown_source":"The information for this source could not be retrieved.","category":"Category","communication":"Communication","transmitter":"Transmitter","receiver":"Receiver","warning":"(!) Highly questioned"}}}')}},[[398,1,2]]]);
//# sourceMappingURL=main.7a1b081d.chunk.js.map